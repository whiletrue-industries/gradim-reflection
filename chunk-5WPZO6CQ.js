import{Ba as w,Da as x,Ea as U,J as l,P as d,Ta as v,Ua as C,X as s,Xa as y,aa as u,ca as g,da as h,ia as m,pa as f,qa as _,xa as i,ya as b,za as c}from"./chunk-MEFDK25W.js";var P=["https://gradim-wall.netlify.app/FB_P_ITA_200021_5770_013","https://gradim-wall.netlify.app/FB_P_FRA_88009_0072_018","https://gradim-wall.netlify.app/FB_P_IND_84010_016_809","https://gradim-wall.netlify.app/FB_P_USA_82002_0211_036","https://gradim-wall.netlify.app/FB_P_SUN_89009_1275_031"];function p(){let r=Math.floor(Math.random()*P.length);return P[r]}function S(r,t){if(r&1&&c(0,"iframe",1),r&2){let e=U();w("src",e.safeContextUrl(),g)}}var M=class r{sanitizer=l(y);platformId=l(u);currentUrl=s("");safeContextUrl=s(null);constructor(){let t=this.getInitialWallUrl();this.currentUrl.set(t),this.safeContextUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(t))}shareToCanvas(){console.log("[UrlWrapper] shareToCanvas clicked");let t=this.currentUrl();if(!t){console.warn("[UrlWrapper] No URL to share");return}let e=this.buildUrlKey();console.log("[UrlWrapper] Generated URL key:",e);try{localStorage.setItem(e,t),console.log("[UrlWrapper] Stored URL in localStorage")}catch(a){console.error("[UrlWrapper] Failed to store URL in localStorage:",a);return}try{localStorage.setItem("wall-url",t)}catch(a){console.warn("[UrlWrapper] Could not store wall-url",a)}let o=`${this.getBasePath()}sample-reflect/?loadUrl=${e}`;console.log("[UrlWrapper] Navigating to canvas:",o),window.location.href=o}buildUrlKey(){let t=globalThis.crypto;if(t?.randomUUID)return`pending-canvas-url-${t.randomUUID()}`;if(t?.getRandomValues){let n=new Uint8Array(16);return t.getRandomValues(n),`pending-canvas-url-${Array.from(n,a=>a.toString(16).padStart(2,"0")).join("")}`}return`pending-canvas-url-${Math.random().toString(36).slice(2)+Date.now().toString(36)}`}getBasePath(){let t=window.location.pathname,e=t.lastIndexOf("/")+1;return t.substring(0,e)}getInitialWallUrl(){if(!C(this.platformId))return p();try{let e=new URLSearchParams(window.location.search).get("wallUrl");if(e)return e}catch{}return p()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=m({type:r,selectors:[["app-url-wrapper"]],decls:6,vars:1,consts:[[1,"url-wrapper-container"],["title","Context View","allow","publickey-credentials-create *; publickey-credentials-get *","sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-downloads",1,"wrapped-iframe",3,"src"],[1,"share-button-container"],["type","button","title","Share to canvas",1,"share-button",3,"click","touchstart"],["width","20","height","20","viewBox","0 0 24 24","fill","currentColor"],["d","M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"]],template:function(e,n){e&1&&(i(0,"div",0),f(1,S,1,1,"iframe",1),i(2,"div",2)(3,"button",3),x("click",function(){return n.shareToCanvas()})("touchstart",function(){return n.shareToCanvas()}),d(),i(4,"svg",4),c(5,"path",5),b()()()()),e&2&&(h(),_(n.safeContextUrl()?1:-1))},dependencies:[v],styles:[".url-wrapper-container[_ngcontent-%COMP%]{position:fixed;inset:0;width:100%;height:100%;overflow:hidden;background:#000}.wrapped-iframe[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;border:none;display:block;z-index:1}.share-button-container[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;z-index:200;pointer-events:auto;display:flex;gap:8px;align-items:center}.button-group[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.share-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;padding:0;background-color:#141414f2;color:#e6e6e6;border:1px solid rgba(255,255,255,.1);border-radius:8px;cursor:pointer;box-shadow:0 2px 12px #00000080;transition:all .2s ease;touch-action:manipulation;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;user-select:none}.share-button[_ngcontent-%COMP%]:hover{background-color:#1e1e1efa;border-color:#fff3;transform:translateY(-2px);box-shadow:0 4px 16px #0009}.share-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #0006}.share-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.share-button.close[_ngcontent-%COMP%]{background-color:#1e1e1ef2}.share-button.saved[_ngcontent-%COMP%]{background-color:#287850e6;border-color:#64c8964d}.share-button.saved[_ngcontent-%COMP%]:hover{background-color:#328c64fa;border-color:#96ffc866}.canvas-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;width:100%;height:100%;z-index:10;background:#0000000d;overflow:hidden}.canvas-overlay.slide-in-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideFromLeft .36s ease-in-out}.canvas-overlay.slide-out-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideToLeft .36s ease-in-out}.canvas-iframe[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;border:none;display:block;box-shadow:0 0 30px #0000004d}@keyframes _ngcontent-%COMP%_slideFromLeft{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}@keyframes _ngcontent-%COMP%_slideToLeft{0%{clip-path:inset(0 0 0 0)}to{clip-path:inset(0 100% 0 0)}}"],changeDetection:0})};export{M as UrlWrapper};
