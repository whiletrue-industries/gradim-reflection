import{a as wt}from"./chunk-DWVYAG5H.js";import{Aa as T,Ca as v,Ea as a,Fa as ht,Ga as pt,Ha as gt,Ia as S,J as $,Ja as D,Ka as M,La as ut,Ma as mt,N as d,O as h,Oa as F,P as U,Pa as ft,Q as G,Sa as vt,Ta as _t,Ua as O,X as x,Xa as bt,Y as tt,a as P,aa as Z,b as V,ba as et,ca as at,da as b,ea as K,ia as R,oa as q,pa as I,qa as k,ra as st,sa as ct,ta as w,ua as p,va as u,wa as j,xa as lt,ya as dt}from"./chunk-MEFDK25W.js";var jt=["*"];var xt=(()=>{class g{platformId=$(Z);fullScreen=ft(!1);isInIframe=x(!1);constructor(){O(this.platformId)&&(this.isInIframe.set(window!==window.parent),this.setupIframeCommunication())}setupIframeCommunication(){this.isInIframe()&&(window.addEventListener("message",e=>{this.handleParentMessage(e)}),this.postMessageToParent({type:"APP_READY",timestamp:Date.now()}))}handleParentMessage(e){let{type:n,data:i}=e.data;switch(n){case"REQUEST_DATA":this.handleDataRequest();break;case"CONFIG_UPDATE":this.handleConfigUpdate(i);break;default:console.warn("Unknown message type from parent:",n)}}handleDataRequest(){this.postMessageToParent({type:"DATA_RESPONSE",data:{title:"",description:"",link:"",imageUrl:"",imageBlob:null,metadata:{itemsUsed:[],tags:[],userId:"",username:"",email:""}}})}handleConfigUpdate(e){console.log("Config update received:",e)}postMessageToParent(e){this.isInIframe()&&O(this.platformId)&&window.parent.postMessage(e,"*")}sendDataToParent(e){this.postMessageToParent({type:"DATA_UPDATE",data:e})}static \u0275fac=function(n){return new(n||g)};static \u0275cmp=R({type:g,selectors:[["lib-layout"]],hostVars:4,hostBindings:function(n,i){n&2&&D("is-iframe",i.isInIframe())("full-screen",i.fullScreen())},inputs:{fullScreen:[1,"fullScreen"]},ngContentSelectors:jt,decls:3,vars:0,consts:[[1,"layout-container"],[1,"layout-content"]],template:function(n,i){n&1&&(ht(),lt(0,"div",0)(1,"div",1),pt(2),dt()())},styles:["[_nghost-%COMP%]{display:block;width:100%;min-height:100vh}.layout-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;width:100%}.layout-content[_ngcontent-%COMP%]{flex:1;width:100%;max-width:1200px;margin:0 auto;padding:16px}@media(min-width:1024px){.layout-content[_ngcontent-%COMP%]{padding:24px}}.is-iframe[_nghost-%COMP%]   .layout-content[_ngcontent-%COMP%]{max-width:100%;padding:8px}.full-screen[_nghost-%COMP%]   .layout-container[_ngcontent-%COMP%]{overflow:hidden}.full-screen[_nghost-%COMP%]   .layout-content[_ngcontent-%COMP%]{max-width:100%;padding:0;margin:0}"],changeDetection:0})}return g})();var It=(g,t)=>t.id;function kt(g,t){if(g&1&&j(0,"img",29),g&2){let e=a().$implicit;w("src",e.content,et)}}function zt(g,t){if(g&1){let e=T();p(0,"img",32),v("load",function(i){d(e);let o=a(2).$implicit,r=a();return h(r.onOgImageLoad(i,o.id))}),u()}if(g&2){let e=a(2).$implicit;w("src",e.ogImage,et)}}function Ht(g,t){if(g&1){let e=T();p(0,"div",36),v("click",function(i){d(e);let o=a(3).$implicit,r=a();return h(r.onIframeOverlayClick(i,o.id))}),p(1,"div",37),M(2," Click to interact "),u()()}}function Vt(g,t){if(g&1){let e=T();p(0,"div",33),v("mouseenter",function(){d(e);let i=a(2).$implicit,o=a();return h(o.onIframeMouseEnter(i.id))})("mouseleave",function(){d(e);let i=a(2).$implicit,o=a();return h(o.onIframeMouseLeave(i.id))}),p(1,"iframe",34),v("load",function(i){d(e);let o=a(2).$implicit,r=a();return h(r.onIframeLoad(i,o.id))}),u(),I(2,Ht,3,0,"div",35),u()}if(g&2){let e=a(2).$implicit,n=a();b(),D("dimmed",n.hoveredIframeId()===e.id)("interactive",n.interactiveIframeId()===e.id),w("src",e.safeUrl||e.content,at),q("scrolling",n.interactiveIframeId()===e.id?"yes":"no"),b(),k(n.hoveredIframeId()===e.id&&n.interactiveIframeId()!==e.id?2:-1)}}function Et(g,t){if(g&1&&I(0,zt,1,1,"img",30)(1,Vt,3,7,"div",31),g&2){let e=a().$implicit;k(e.displayMode==="image"&&e.ogImage?0:1)}}function Dt(g,t){if(g&1){let e=T();p(0,"div",38)(1,"button",52),v("click",function(){d(e);let i=a(2).$implicit,o=a();return h(o.toggleDisplayMode(i.id))}),U(),p(2,"svg",10),j(3,"path",53)(4,"path",54),u()(),G(),p(5,"button",55),v("click",function(){d(e);let i=a(2).$implicit,o=a();return h(o.toggleDisplayMode(i.id))}),U(),p(6,"svg",10),j(7,"path",56),u()()()}if(g&2){let e=a(2).$implicit,n=a();w("ngStyle",n.getInverseScaleStyle(e)),b(),D("active",e.displayMode==="image"),b(4),D("active",e.displayMode==="iframe")}}function Ft(g,t){if(g&1){let e=T();I(0,Dt,8,5,"div",38),j(1,"div",39),p(2,"div",40),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-nw"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-nw"))}),u(),p(3,"div",41),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-ne"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-ne"))}),u(),p(4,"div",42),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-sw"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-sw"))}),u(),p(5,"div",43),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-se"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-se"))}),u(),p(6,"div",44),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-w"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-w"))}),u(),p(7,"div",45),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-e"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-e"))}),u(),p(8,"div",46),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-n"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-n"))}),u(),p(9,"div",47),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"scale-s"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"scale-s"))}),u(),p(10,"div",48),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"rotate-nw"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"rotate-nw"))}),u(),p(11,"div",49),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"rotate-ne"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"rotate-ne"))}),u(),p(12,"div",50),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"rotate-sw"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"rotate-sw"))}),u(),p(13,"div",51),v("mousedown",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleMouseDown(i,o.id,"rotate-se"))})("touchstart",function(i){d(e);let o=a().$implicit,r=a();return h(r.onHandleTouchStart(i,o.id,"rotate-se"))}),u()}if(g&2){let e=a().$implicit,n=a();k(e.type==="iframe"&&e.ogImage?0:-1),b(),w("ngStyle",n.getSelectionBorderStyle()),b(),S("cursor",n.getCursorForHandle(e,"scale-nw")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getCursorForHandle(e,"scale-ne")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getCursorForHandle(e,"scale-sw")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getCursorForHandle(e,"scale-se")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getCursorForHandle(e,"scale-w")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getCursorForHandle(e,"scale-e")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getCursorForHandle(e,"scale-n")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getCursorForHandle(e,"scale-s")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getRotateCursor(e,"nw")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getRotateCursor(e,"ne")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getRotateCursor(e,"sw")),w("ngStyle",n.getInverseScaleStyle(e)),b(),S("cursor",n.getRotateCursor(e,"se")),w("ngStyle",n.getInverseScaleStyle(e))}}function Lt(g,t){if(g&1){let e=T();p(0,"div",27),v("click",function(i){let o=d(e).$implicit,r=a();return h(r.onObjectClick(i,o.id))})("mousedown",function(i){let o=d(e).$implicit,r=a();return h(r.onObjectMouseDown(i,o.id))})("touchstart",function(i){let o=d(e).$implicit,r=a();return h(r.onObjectTouchStart(i,o.id))}),j(1,"div",28),I(2,kt,1,1,"img",29)(3,Et,2,1),I(4,Ft,14,38),u()}if(g&2){let e=t.$implicit,n=a();D("selected",n.selectedObjectId()===e.id),w("ngStyle",n.getObjectStyle(e)),b(),w("ngStyle",n.getSelectionBorderStyle()),b(),k(e.type==="image"?2:e.type==="iframe"?3:-1),b(2),k(n.selectedObjectId()===e.id?4:-1)}}function Ut(g,t){if(g&1){let e=T();p(0,"div",6)(1,"button",57),v("click",function(){d(e);let i=a();return h(i.returnToUrlWrapper())}),U(),p(2,"svg",58),j(3,"path",59),u()()()}}function Rt(g,t){if(g&1){let e=T();p(0,"div",16)(1,"button",60),v("click",function(){d(e);let i=a();return i.shareImage(),h(i.shareMenuOpen.set(!1))}),p(2,"span"),M(3,"Share Image"),u()(),p(4,"button",60),v("click",function(){d(e);let i=a();return i.shareComposition(),h(i.shareMenuOpen.set(!1))}),p(5,"span"),M(6,"Share Link"),u()()()}}function At(g,t){if(g&1){let e=T();p(0,"div",20)(1,"button",61),v("click",function(){d(e);let i=a();return h(i.onAddImageClick())}),M(2,"\u{1F4F7} Image"),u(),p(3,"button",61),v("click",function(){d(e);let i=a();return h(i.onAddUrlClick())}),M(4,"\u{1F517} URL"),u()()}}function Yt(g,t){if(g&1){let e=T();p(0,"div",62),v("click",function(){d(e);let i=a();return h(i.cancelUrlModal())}),p(1,"div",63),v("click",function(i){return d(e),h(i.stopPropagation())}),p(2,"h3"),M(3,"Add URL"),u(),p(4,"input",64,1),v("input",function(){d(e);let i=gt(5),o=a();return h(o.urlInputValue.set(i.value))})("keydown.enter",function(){d(e);let i=a();return h(i.submitUrlModal())})("keydown.escape",function(){d(e);let i=a();return h(i.cancelUrlModal())}),u(),p(6,"div",65)(7,"button",66),v("click",function(){d(e);let i=a();return h(i.cancelUrlModal())}),M(8,"Cancel"),u(),p(9,"button",67),v("click",function(){d(e);let i=a();return h(i.submitUrlModal())}),M(10,"Add"),u()()()()}if(g&2){let e=a();b(4),w("value",e.urlInputValue())}}var Q=class g{platformId=$(Z);sanitizer=$(bt);baseSize=200;dataTokenPrefix="data-token-";dataFilePrefix="file-data-";minZoom=.1;maxZoom=5;hashUpdateHandle=null;hashThrottleMs=300;lastSerializedHash="";suppressHash=!1;hashDirty=!1;skipNextHashWrite=!1;readyForHashWrites=!1;initialFitDone=!1;restoredFromHash=!1;wheelFlushHandle=null;ephemeralTokens=new Map;defaultIframeWidth=600;defaultIframeHeight=400;defaultViewportWidth=1920;defaultViewportHeight=1080;transparentPixel="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMB/hsrLxkAAAAASUVORK5CYII=";touchStartDistance=0;touchStartZoom=1;isTouchPinching=!1;activeTouches=0;isMobile=x(!1);instructionsText=F(()=>this.isMobile()?"Tap to select \u2022 Pinch to zoom \u2022 Two fingers to pan":"Drag & drop images \u2022 Paste URLs (Ctrl/Cmd+V) \u2022 Scroll to zoom");objects=x([]);selectedObjectId=x(null);selectedObject=F(()=>{let t=this.selectedObjectId();return t?this.objects().find(e=>e.id===t):null});viewportX=x(0);viewportY=x(0);zoom=x(1);shareMenuOpen=x(!1);addMenuOpen=x(!1);showUrlModal=x(!1);urlInputValue=x("");cameFromUrlWrapper=x(!1);urlWrapperUrl=x(null);hoveredIframeId=x(null);interactiveIframeId=x(null);hoverTimeoutHandle=null;iframeScrollUpdateMap=new WeakMap;baseGridSize=20;gridScaleLevels=[.25,.5,1,2,4,8,16];minVisibleGridSize=8;maxVisibleGridSize=50;gridScale=x(1);gridSize=F(()=>this.baseGridSize*this.gridScale());apparentGridSize=F(()=>this.gridSize()*this.zoom());gridOpacity=F(()=>{let t=this.apparentGridSize();return t<this.minVisibleGridSize?Math.max(0,t/this.minVisibleGridSize):t>this.maxVisibleGridSize?Math.max(0,1-(t-this.maxVisibleGridSize)/(this.maxVisibleGridSize*.5)):1});zoomPercentage=F(()=>Math.round(this.zoom()*100));isDragging=!1;isTransforming=!1;isPanningCanvas=!1;dragStartX=0;dragStartY=0;transformStartX=0;transformStartY=0;transformHandle=null;originalObject=null;panStartViewportX=0;panStartViewportY=0;rotateStartAngle=0;rotateStartRotation=0;viewAnimationFrame=null;pendingInitialFitTimeout=null;pendingFitAfterImageLoad=!1;safeInsetTop=20;safeInsetBottom=100;safeInsetLeft=20;safeInsetRight=20;getVisibleViewportMetrics(){let t=Math.max(0,window.innerWidth-this.safeInsetLeft-this.safeInsetRight),e=Math.max(0,window.innerHeight-this.safeInsetTop-this.safeInsetBottom),n=this.safeInsetLeft+t/2,i=this.safeInsetTop+e/2;return{width:t,height:e,centerX:n,centerY:i}}transformHandles=[{type:"scale-nw",cursor:"nw-resize"},{type:"scale-ne",cursor:"ne-resize"},{type:"scale-sw",cursor:"sw-resize"},{type:"scale-se",cursor:"se-resize"},{type:"scale-w",cursor:"w-resize"},{type:"scale-e",cursor:"e-resize"},{type:"scale-n",cursor:"n-resize"},{type:"scale-s",cursor:"s-resize"},{type:"rotate",cursor:"grab"}];constructor(){if(O(this.platformId)){this.setupEventListeners(),window.addEventListener("hashchange",this.onHashChange),window.addEventListener("keydown",e=>this.onKeyDown(e)),K(()=>{this.isMobile.set(this.detectMobile())}),tt(()=>{this.viewportX(),this.viewportY(),this.zoom(),this.objects(),this.readyForHashWrites?this.scheduleHashUpdate():this.hashDirty=!0}),tt(()=>{let e=this.zoom();this.updateGridScale(e)});let t="";try{let e=window.location.hash,n=sessionStorage.getItem("canvasLastHash"),i=window.location.search.includes("shareUrl=");e&&e!=="#"?t=e:n&&!i?(t=n.startsWith("#")?n:`#${n}`,window.history.replaceState(null,"",t)):!n&&(!e||e==="#")&&!i&&(sessionStorage.removeItem("canvasLastHash"),this.skipNextHashWrite=!0,t="")}catch{t=window.location.hash}this.restoredFromHash=!!t,this.suppressHash=!0,t&&this.applyHashState(t),this.suppressHash=!1,this.readyForHashWrites=!0,this.hashDirty&&this.scheduleHashUpdate(),K(()=>{this.cleanupOrphanedStorage();try{let e=new URLSearchParams(window.location.search),n=e.get("shareUrl");if(n){this.cameFromUrlWrapper.set(!0),this.urlWrapperUrl.set(n);try{localStorage.setItem("wall-url",n)}catch(r){console.warn("[Canvas] Could not store wall-url",r)}this.objects().some(r=>r.sourceRef===n)||this.addUrlObject(n),this.pendingInitialFitTimeout!==null&&window.clearTimeout(this.pendingInitialFitTimeout),this.pendingInitialFitTimeout=window.setTimeout(()=>{this.pendingInitialFitTimeout!==null&&(this.animateFitToContent(),this.pendingInitialFitTimeout=null)},1500),e.delete("shareUrl");let o=window.location.pathname+(e.toString()?"?"+e.toString():"")+window.location.hash;window.history.replaceState(null,"",o)}}catch{}})}}addUrlObject(t){let e=this.defaultViewportWidth/2-this.defaultIframeWidth/2,n=this.defaultViewportHeight/2-this.defaultIframeHeight/2,i=this.defaultIframeWidth>0?this.defaultIframeHeight/this.defaultIframeWidth:1,o=this.zoom()||1,r={id:this.generateId(),type:"iframe",x:e/o,y:n/o,width:this.defaultIframeWidth,height:this.defaultIframeHeight,rotation:0,content:t,sourceRef:t,originalAspectRatio:i,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(t),displayMode:"image"};this.addObject(r),this.pendingFitAfterImageLoad=!0,this.fetchOgImage(t,r.id)}fitOnceAfterLoad(){this.initialFitDone||(this.initialFitDone=!0,K(()=>this.animateFitToContent()))}animateFitToContent(){let t=this.computeFitToViewTargets(),e=this.calculateCompositionBounds();if(e){let{centerY:n}=this.getVisibleViewportMetrics(),i=e.y+e.height/2;this.zoom.set(t.zoom*.5),this.viewportX.set(-e.width*t.zoom),this.viewportY.set(n-i*t.zoom*.5)}this.animateToView(t.zoom,t.viewportX,t.viewportY,450)}animateToView(t,e,n,i=450){let o=this.zoom(),r=this.viewportX(),s=this.viewportY(),c=performance.now();this.viewAnimationFrame!==null&&(cancelAnimationFrame(this.viewAnimationFrame),this.viewAnimationFrame=null);let l=f=>1-Math.pow(1-f,3),m=()=>{let f=performance.now()-c,_=Math.min(1,f/i),C=l(_);this.zoom.set(o+(t-o)*C),this.viewportX.set(r+(e-r)*C),this.viewportY.set(s+(n-s)*C),_<1?this.viewAnimationFrame=requestAnimationFrame(m):this.viewAnimationFrame=null};this.viewAnimationFrame=requestAnimationFrame(m)}returnToUrlWrapper(){if(!O(this.platformId))return;let t=this.urlWrapperUrl()||localStorage.getItem("wall-url"),e=this.computeBasePath();t?window.location.href=`${e}?wallUrl=${encodeURIComponent(t)}`:window.location.href=e}computeBasePath(){let t=window.location.pathname,e=t.indexOf("/sample-reflect");return e>=0?t.substring(0,e+1):"/"}onHashChange=()=>{if(!O(this.platformId))return;let t=window.location.hash||"";if(!t||t==="#"){try{sessionStorage.removeItem("canvasLastHash")}catch{}this.lastSerializedHash="",this.suppressHash=!0,this.objects.set([]),this.selectedObjectId.set(null),this.viewportX.set(0),this.viewportY.set(0),this.zoom.set(1),this.suppressHash=!1,this.hashDirty=!1,this.skipNextHashWrite=!0;return}let e=this.serializeStateToHash(),n=e?`#${e}`:"";if(!(t===n||t===this.lastSerializedHash)){if(this.objects().length>0&&t.length<this.lastSerializedHash.length){this.lastSerializedHash=n;return}this.applyHashState(t),this.lastSerializedHash=t}};setupEventListeners(){window.addEventListener("paste",t=>this.onPaste(t)),window.addEventListener("dragover",t=>t.preventDefault()),window.addEventListener("wheel",t=>this.onWheel(t),{passive:!1}),window.addEventListener("touchstart",t=>this.onTouchStart(t),{passive:!1}),window.addEventListener("touchmove",t=>this.onTouchMove(t),{passive:!1}),window.addEventListener("touchend",t=>this.onTouchEnd(t),{passive:!1}),window.addEventListener("resize",()=>{this.isMobile.set(this.detectMobile())})}detectMobile(){if(!O(this.platformId))return!1;let t=window.innerWidth<=768,e="ontouchstart"in window||navigator.maxTouchPoints>0,n=navigator.userAgent.toLowerCase(),i=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(n);return t||e&&i}onDrop(t){t.preventDefault(),t.stopPropagation();let e=t.dataTransfer?.files;if(e&&e.length>0){let n=e[0];if(n.type.startsWith("image/")){let i=new FileReader;i.onload=()=>{let o=t.currentTarget,r=o?o.getBoundingClientRect():{left:0,top:0},s=t.clientX-r.left-this.viewportX(),c=t.clientY-r.top-this.viewportY(),l=i.result,m=this.deriveSourceRef(l,n.name),f=new Image;f.onload=()=>{let _=f.naturalHeight/f.naturalWidth||1;this.addObject({id:this.generateId(),type:"image",x:s/this.zoom(),y:c/this.zoom(),width:this.baseSize,height:this.baseSize*_,rotation:0,content:l,sourceRef:m,originalAspectRatio:_})},f.onerror=()=>{this.addObject({id:this.generateId(),type:"image",x:s/this.zoom(),y:c/this.zoom(),width:this.baseSize,height:this.baseSize,rotation:0,content:l,sourceRef:m,originalAspectRatio:1})},f.src=l},i.readAsDataURL(n)}}}onDragOver(t){t.preventDefault(),t.stopPropagation()}onPaste(t){let e=t.target,n=document.activeElement,i=r=>!!r&&(r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable||r.closest(".url-input")!==null);if(i(e)||i(n))return;let o=t.clipboardData?.getData("text");if(o&&this.isValidUrl(o)){let r=this.deriveSourceRef(o),s={id:this.generateId(),type:"iframe",x:(window.innerWidth/2-this.viewportX())/this.zoom(),y:(window.innerHeight/2-this.viewportY())/this.zoom(),width:600,height:400,rotation:0,content:o,sourceRef:r,originalAspectRatio:400/600,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(o),displayMode:"image"};this.addObject(s),this.fetchOgImage(o,s.id),t.preventDefault()}}onFileSelected(t){let e=t.target,n=e.files&&e.files[0];if(!n||!n.type.startsWith("image/"))return;let i=new FileReader;i.onload=()=>{let o=i.result,r=this.deriveSourceRef(o,n.name),s=new Image;s.onload=()=>{let c=s.naturalHeight/s.naturalWidth||1,l=(window.innerWidth/2-this.viewportX())/this.zoom(),m=(window.innerHeight/2-this.viewportY())/this.zoom();this.addObject({id:this.generateId(),type:"image",x:l-this.baseSize/2,y:m-this.baseSize*c/2,width:this.baseSize,height:this.baseSize*c,rotation:0,content:o,sourceRef:r,originalAspectRatio:c})},s.onerror=()=>{let c=(window.innerWidth/2-this.viewportX())/this.zoom(),l=(window.innerHeight/2-this.viewportY())/this.zoom();this.addObject({id:this.generateId(),type:"image",x:c-this.baseSize/2,y:l-this.baseSize/2,width:this.baseSize,height:this.baseSize,rotation:0,content:o,sourceRef:r,originalAspectRatio:1})},s.src=o},i.readAsDataURL(n),e.value=""}isValidUrl(t){try{return new URL(t),!0}catch{return!1}}async fetchOgImage(t,e){if(!O(this.platformId))return;let n=window.location.hostname.toLowerCase(),i=n==="localhost"||n==="127.0.0.1"||n==="::1",o=this.getGradimWallOgImage(t);if(o){this.updateObjectOgImage(e,o);return}if(!i){this.trySetDevelopmentOgImage(t,e);return}let r=!1;try{let s=`/api/url-metadata?url=${encodeURIComponent(t)}`,c=await fetch(s),l=c.headers.get("content-type");if(c.ok&&l?.includes("application/json")){let m=await c.json();m.ogImage&&(this.updateObjectOgImage(e,m.ogImage),r=!0)}}catch{}r||this.trySetDevelopmentOgImage(t,e)}trySetDevelopmentOgImage(t,e){try{let n=new URL(t),i=n.hostname.toLowerCase(),r={"github.com":"https://github.githubassets.com/images/modules/site/social-cards/github-social.png","www.github.com":"https://github.githubassets.com/images/modules/site/social-cards/github-social.png","youtube.com":"https://www.youtube.com/img/desktop/yt_1200.png","www.youtube.com":"https://www.youtube.com/img/desktop/yt_1200.png"}[i];!r&&i==="gradim-wall.netlify.app"&&(r=this.getGradimWallOgImage(n.toString())||void 0),r&&setTimeout(()=>{this.updateObjectOgImage(e,r)},500)}catch{}}getGradimWallOgImage(t){try{let e=new URL(t);if(e.hostname.toLowerCase()!=="gradim-wall.netlify.app")return null;let n=e.pathname.split("/").filter(Boolean),i=decodeURIComponent(n[n.length-1]||"");if(i&&/^[A-Za-z0-9_\-]+$/.test(i))return`https://gradim.fh-potsdam.de/omeka-s/files/large/${i}.jpg`}catch{}return null}extractOgImage(t){let e=t.match(/<meta[^>]*property=["']og:image["'][^>]*content=["']([^"']*)["'][^>]*>/i)||t.match(/<meta[^>]*content=["']([^"']*)["'][^>]*property=["']og:image["'][^>]*>/i);return e?e[1]:null}updateObjectOgImage(t,e){let n=new Image;n.onload=()=>{let i=n.naturalHeight/n.naturalWidth||1,o=600,r=o*i;this.objects.update(s=>s.map(c=>c.id===t?V(P({},c),{ogImage:e,width:o,height:r,originalAspectRatio:i,displayMode:"image"}):c)),this.scheduleHashUpdate(),this.pendingInitialFitTimeout!==null&&(window.clearTimeout(this.pendingInitialFitTimeout),this.pendingInitialFitTimeout=null),this.pendingFitAfterImageLoad&&(this.pendingFitAfterImageLoad=!1,this.animateFitToContent())},n.onerror=()=>{this.objects.update(i=>i.map(o=>o.id===t?V(P({},o),{ogImage:e}):o))},n.src=e}toggleDisplayMode(t){let e=this.objects().find(i=>i.id===t);if(!e||e.type!=="iframe"||!e.ogImage)return;let n=e.displayMode==="iframe"?"image":"iframe";this.objects.update(i=>i.map(o=>o.id===t?V(P({},o),{displayMode:n}):o)),this.scheduleHashUpdate()}setOgImageForTesting(t){if(!this.isValidUrl(t)){console.error("Invalid URL format:",t);return}let e=this.selectedObjectId();if(!e){console.warn("No object selected. Please select an iframe object first.");return}let n=this.objects().find(i=>i.id===e);if(!n||n.type!=="iframe"){console.warn("Selected object is not an iframe.");return}this.updateObjectOgImage(e,t),console.log("og:image set to:",t,"- toggle buttons should now be visible")}addObject(t){this.objects.update(e=>[...e,t]),this.selectedObjectId.set(t.id),this.scheduleHashUpdate()}onKeyDown(t){if(t.key!=="Backspace")return;let e=t.target;if(e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable))return;let n=this.selectedObjectId();if(!n)return;t.preventDefault();let i=this.objects().find(o=>o.id===n);i&&this.cleanupObjectStorage(i),this.objects.update(o=>o.filter(r=>r.id!==n)),this.selectedObjectId.set(null)}onObjectClick(t,e){t.stopPropagation(),this.selectedObjectId.set(e),(this.objects().find(i=>i.id===e)?.type!=="iframe"||this.interactiveIframeId()!==e)&&(this.interactiveIframeId.set(null),this.updateAllIframeScrollStates())}onCanvasClick(t){let e=t.target,n=e===t.currentTarget||e.classList.contains("dot-grid")||e.classList.contains("canvas-objects");this.hashDirty&&this.scheduleHashUpdate(),n&&(this.selectedObjectId.set(null),this.interactiveIframeId.set(null),this.updateAllIframeScrollStates())}onCanvasMouseDown(t){if(t.target===t.currentTarget||t.target.classList.contains("dot-grid")){this.suppressHash=!0,this.selectedObjectId.set(null),this.isPanningCanvas=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY,this.panStartViewportX=this.viewportX(),this.panStartViewportY=this.viewportY();let e=i=>{if(!this.isPanningCanvas)return;let o=i.clientX-this.dragStartX,r=i.clientY-this.dragStartY;this.viewportX.set(this.panStartViewportX+o),this.viewportY.set(this.panStartViewportY+r)},n=()=>{this.isPanningCanvas=!1,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",n)};window.addEventListener("mousemove",e),window.addEventListener("mouseup",n)}}onCanvasTouchStart(t){if(t.touches.length===2){let e=t.target;if(e===t.currentTarget||e?.classList&&(e.classList.contains("dot-grid")||e.classList.contains("canvas-objects"))){t.preventDefault(),this.suppressHash=!0,this.selectedObjectId.set(null),this.isPanningCanvas=!0;let i=t.touches[0],o=t.touches[1],r=(i.clientX+o.clientX)/2,s=(i.clientY+o.clientY)/2;this.dragStartX=r,this.dragStartY=s,this.panStartViewportX=this.viewportX(),this.panStartViewportY=this.viewportY();let c=m=>{if(!this.isPanningCanvas||m.touches.length!==2)return;let f=m.touches[0],_=m.touches[1],C=(f.clientX+_.clientX)/2,z=(f.clientY+_.clientY)/2,H=C-this.dragStartX,L=z-this.dragStartY;this.viewportX.set(this.panStartViewportX+H),this.viewportY.set(this.panStartViewportY+L)},l=()=>{this.isPanningCanvas=!1,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",l)};window.addEventListener("touchmove",c),window.addEventListener("touchend",l)}}}onObjectMouseMove(t,e){}onObjectMouseLeave(t){}updateAllIframeScrollStates(){setTimeout(()=>{document.querySelectorAll("iframe.object-content").forEach(e=>{let n=e,i=this.iframeScrollUpdateMap.get(n);i&&i()})},0)}clearHoverTimeout(){this.hoverTimeoutHandle&&(clearTimeout(this.hoverTimeoutHandle),this.hoverTimeoutHandle=null)}onIframeMouseEnter(t){this.clearHoverTimeout(),this.hoverTimeoutHandle=setTimeout(()=>{this.interactiveIframeId()!==t&&this.hoveredIframeId.set(t)},500)}onIframeMouseLeave(t){this.clearHoverTimeout(),this.hoveredIframeId()===t&&this.hoveredIframeId.set(null)}onIframeOverlayClick(t,e){t.stopPropagation(),this.interactiveIframeId.set(e),this.hoveredIframeId.set(null),this.clearHoverTimeout(),this.updateAllIframeScrollStates()}updateGridScale(t){let e=this.gridScaleLevels[0],n=1/0;for(let i of this.gridScaleLevels){let o=this.baseGridSize*i*t,r=(this.minVisibleGridSize+this.maxVisibleGridSize)/2,s=Math.abs(o-r);s<n&&(n=s,e=i)}this.gridScale.set(e)}computeFitToViewTargets(){if(this.objects().length===0)return{zoom:1,viewportX:0,viewportY:0};let e=this.calculateCompositionBounds();if(!e)return{zoom:1,viewportX:0,viewportY:0};let i=this.isMobile()?20:40,{width:o,height:r,centerX:s,centerY:c}=this.getVisibleViewportMetrics(),l=Math.max(0,o-2*i),m=Math.max(0,r-2*i),f=l/e.width,_=m/e.height,C=Math.min(f,_,this.maxZoom),z=e.x+e.width/2,H=e.y+e.height/2,L=s,N=c,W=L-z*C,E=N-H*C;return{zoom:C,viewportX:W,viewportY:E}}fitToView(){let{zoom:t,viewportX:e,viewportY:n}=this.computeFitToViewTargets();this.zoom.set(t),this.viewportX.set(e),this.viewportY.set(n)}onWheel(t){t.preventDefault(),this.suppressHash=!0;let n=t.deltaY>0?.9:1.1,i=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoom()*n)),o=t.clientX,r=t.clientY,s=(o-this.viewportX())/this.zoom(),c=(r-this.viewportY())/this.zoom();this.zoom.set(i),this.viewportX.set(o-s*i),this.viewportY.set(r-c*i),this.wheelFlushHandle&&window.clearTimeout(this.wheelFlushHandle),this.wheelFlushHandle=window.setTimeout(()=>{this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),this.wheelFlushHandle=null},300)}async onShareClick(){try{await this.shareComposition()}catch(t){console.error("Failed to share composition:",t)}}toggleAddMenu(){this.addMenuOpen.update(t=>!t),this.addMenuOpen()&&this.shareMenuOpen.set(!1)}onAddImageClick(){document.querySelector('input[type="file"]')?.click(),this.addMenuOpen.set(!1)}onAddUrlClick(){this.addMenuOpen.set(!1),this.urlInputValue.set(""),this.showUrlModal.set(!0),setTimeout(()=>{document.querySelector(".url-input")?.focus()},100)}submitUrlModal(){let t=this.urlInputValue().trim();this.showUrlModal.set(!1),t&&this.addIframeFromUrl(t)}cancelUrlModal(){this.showUrlModal.set(!1),this.urlInputValue.set("")}addIframeFromUrl(t){if(!this.isValidUrl(t)){console.warn("Invalid URL:",t);return}let e=this.deriveSourceRef(t),n=this.getGradimWallOgImage(t),i={id:this.generateId(),type:"iframe",x:(window.innerWidth/2-this.viewportX())/this.zoom(),y:(window.innerHeight/2-this.viewportY())/this.zoom(),width:600,height:400,rotation:0,content:t,sourceRef:e,originalAspectRatio:400/600,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(t),displayMode:"image",ogImage:n??void 0};this.addObject(i),n||this.fetchOgImage(t,i.id)}onTouchStart(t){if(this.activeTouches=t.touches.length,t.touches.length===2){t.preventDefault(),this.isTouchPinching=!0,this.suppressHash=!0;let e=t.touches[0],n=t.touches[1];this.touchStartDistance=this.getTouchDistance(e,n),this.touchStartZoom=this.zoom()}else t.touches.length}onTouchMove(t){if(t.touches.length===2&&this.isTouchPinching){t.preventDefault();let e=t.touches[0],n=t.touches[1],i=this.getTouchDistance(e,n);if(this.touchStartDistance>0){let o=i/this.touchStartDistance,r=Math.max(this.minZoom,Math.min(this.maxZoom,this.touchStartZoom*o)),s=(e.clientX+n.clientX)/2,c=(e.clientY+n.clientY)/2,l=(s-this.viewportX())/this.zoom(),m=(c-this.viewportY())/this.zoom();this.zoom.set(r),this.viewportX.set(s-l*r),this.viewportY.set(c-m*r)}}}onTouchEnd(t){this.activeTouches=t.touches.length,t.touches.length<2&&(this.isTouchPinching=!1,this.touchStartDistance=0,t.touches.length===0&&(this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate()))}getTouchDistance(t,e){let n=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(n*n+i*i)}onObjectMouseDown(t,e){t.preventDefault(),t.stopPropagation();let n=this.objects().find(r=>r.id===e);if(!n)return;this.isDragging=!0,this.suppressHash=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY,this.originalObject=P({},n),this.selectedObjectId.set(e);let i=r=>{if(!this.isDragging||!this.originalObject)return;let s=(r.clientX-this.dragStartX)/this.zoom(),c=(r.clientY-this.dragStartY)/this.zoom();this.objects.update(l=>l.map(m=>m.id===e?V(P({},m),{x:this.originalObject.x+s,y:this.originalObject.y+c}):m))},o=()=>{this.isDragging=!1,this.originalObject=null,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",i),window.addEventListener("mouseup",o)}onHandleMouseDown(t,e,n){t.preventDefault(),t.stopPropagation();let i=this.objects().find(s=>s.id===e);if(!i)return;this.isTransforming=!0,this.suppressHash=!0,this.transformStartX=t.clientX,this.transformStartY=t.clientY,this.transformHandle=n,this.originalObject=P({},i),this.rotateStartRotation=i.rotation,this.rotateStartAngle=this.getPointerAngle(i,t.clientX,t.clientY);let o=s=>{if(!this.isTransforming||!this.originalObject)return;let c=(s.clientX-this.transformStartX)/this.zoom(),l=(s.clientY-this.transformStartY)/this.zoom();this.transformHandle?.startsWith("rotate-")?this.handleRotate(e,s.clientX,s.clientY):this.transformHandle==="rotate"?this.handleRotate(e,s.clientX,s.clientY):this.transformHandle?.startsWith("scale-")&&this.handleScale(e,c,l,this.transformHandle)},r=()=>{this.isTransforming=!1,this.originalObject=null,this.transformHandle=null,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",r)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",r)}onObjectTouchStart(t,e){if(t.touches.length!==1)return;t.preventDefault(),t.stopPropagation();let n=this.objects().find(s=>s.id===e);if(!n)return;let i=t.touches[0];this.isDragging=!0,this.suppressHash=!0,this.dragStartX=i.clientX,this.dragStartY=i.clientY,this.originalObject=P({},n),this.selectedObjectId.set(e);let o=s=>{if(!this.isDragging||!this.originalObject||s.touches.length!==1)return;let c=s.touches[0],l=(c.clientX-this.dragStartX)/this.zoom(),m=(c.clientY-this.dragStartY)/this.zoom();this.objects.update(f=>f.map(_=>_.id===e?V(P({},_),{x:this.originalObject.x+l,y:this.originalObject.y+m}):_))},r=()=>{this.isDragging=!1,this.originalObject=null,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("touchmove",o),window.removeEventListener("touchend",r)};window.addEventListener("touchmove",o),window.addEventListener("touchend",r)}onHandleTouchStart(t,e,n){if(t.touches.length!==1)return;t.preventDefault(),t.stopPropagation();let i=this.objects().find(c=>c.id===e);if(!i)return;let o=t.touches[0];this.isTransforming=!0,this.suppressHash=!0,this.transformStartX=o.clientX,this.transformStartY=o.clientY,this.transformHandle=n,this.originalObject=P({},i),this.rotateStartRotation=i.rotation,this.rotateStartAngle=this.getPointerAngle(i,o.clientX,o.clientY);let r=c=>{if(!this.isTransforming||!this.originalObject||c.touches.length!==1)return;let l=c.touches[0],m=(l.clientX-this.transformStartX)/this.zoom(),f=(l.clientY-this.transformStartY)/this.zoom();this.transformHandle?.startsWith("rotate-")?this.handleRotate(e,l.clientX,l.clientY):this.transformHandle==="rotate"?this.handleRotate(e,l.clientX,l.clientY):this.transformHandle?.startsWith("scale-")&&this.handleScale(e,m,f,this.transformHandle)},s=()=>{this.isTransforming=!1,this.originalObject=null,this.transformHandle=null,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("touchmove",r),window.removeEventListener("touchend",s)};window.addEventListener("touchmove",r),window.addEventListener("touchend",s)}handleScale(t,e,n,i){if(!this.originalObject)return;let o=this.originalObject.width,r=this.originalObject.height,s=0,c=0;if(i==="scale-nw"){let l=(-e-n)/2;o=Math.max(50,this.originalObject.width+l),r=o*this.originalObject.originalAspectRatio,s=this.originalObject.width-o,c=this.originalObject.height-r}else if(i==="scale-ne"){let l=(e-n)/2;o=Math.max(50,this.originalObject.width+l),r=o*this.originalObject.originalAspectRatio,c=this.originalObject.height-r}else if(i==="scale-sw"){let l=(-e+n)/2;o=Math.max(50,this.originalObject.width+l),r=o*this.originalObject.originalAspectRatio,s=this.originalObject.width-o}else if(i==="scale-se"){let l=(e+n)/2;o=Math.max(50,this.originalObject.width+l),r=o*this.originalObject.originalAspectRatio}else i==="scale-w"?(o=Math.max(50,this.originalObject.width-e),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:this.originalObject.height,s=this.originalObject.width-o,this.originalObject.type==="image"&&(c=(this.originalObject.height-r)/2)):i==="scale-e"?(o=Math.max(50,this.originalObject.width+e),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:this.originalObject.height,this.originalObject.type==="image"&&(c=(this.originalObject.height-r)/2)):i==="scale-n"?(r=Math.max(50,this.originalObject.height-n),o=this.originalObject.type==="image"?r/this.originalObject.originalAspectRatio:this.originalObject.width,c=this.originalObject.height-r,this.originalObject.type==="image"&&(s=(this.originalObject.width-o)/2)):i==="scale-s"&&(r=Math.max(50,this.originalObject.height+n),o=this.originalObject.type==="image"?r/this.originalObject.originalAspectRatio:this.originalObject.width,this.originalObject.type==="image"&&(s=(this.originalObject.width-o)/2));this.objects.update(l=>l.map(m=>m.id===t?V(P({},m),{width:o,height:r,x:this.originalObject.x+s,y:this.originalObject.y+c}):m))}handleRotate(t,e,n){if(!this.originalObject)return;let i=this.objects().find(l=>l.id===t);if(!i)return;let r=this.getPointerAngle(i,e,n)-this.rotateStartAngle,s=this.rotateStartRotation+r,c=this.snapAngleWithin(s,45,2);this.objects.update(l=>l.map(m=>m.id===t?V(P({},m),{rotation:c}):m))}getPointerAngle(t,e,n){let i=(t.x+t.width/2)*this.zoom()+this.viewportX(),o=(t.y+t.height/2)*this.zoom()+this.viewportY();return Math.atan2(n-o,e-i)*(180/Math.PI)}getObjectStyle(t){return{left:`${t.x}px`,top:`${t.y}px`,width:`${t.width}px`,height:`${t.height}px`,transform:`rotate(${t.rotation}deg)`}}snapAngle(t,e=45){return Math.round(t/e)*e}snapAngleWithin(t,e=45,n=2){let i=Math.round(t/e)*e;return Math.abs(t-i)<=n?i:t}getHandlePosition(t,e){return{"scale-nw":{top:"-5px",left:"-5px"},"scale-ne":{top:"-5px",right:"-5px"},"scale-sw":{bottom:"-5px",left:"-5px"},"scale-se":{bottom:"-5px",right:"-5px"},rotate:{top:"-30px",left:"50%",transform:"translateX(-50%)"}}[e.type]||{}}getCanvasObjectsStyle(){return{transform:`translate(${this.viewportX()}px, ${this.viewportY()}px) scale(${this.zoom()})`,"transform-origin":"0 0"}}getDotGridStyle(){let e=this.gridSize()*this.zoom(),n=this.viewportX()%e,i=this.viewportY()%e;return{"background-size":`${e}px ${e}px`,"background-position":`${n}px ${i}px`,opacity:this.gridOpacity().toString()}}getInverseScaleStyle(t){let e=1/this.zoom();return{transform:`scale(${e})`,"--inverse-scale":e.toString()}}getSelectionBorderStyle(){return{"--inverse-scale":(1/this.zoom()).toString()}}onOgImageLoad(t,e){this.pendingFitAfterImageLoad&&(this.pendingFitAfterImageLoad=!1,this.animateFitToContent())}onIframeLoad(t,e){let n=t.target;if(!n)return;let i=()=>{try{let o=n.contentDocument||n.contentWindow?.document||null;if(!o)return;let r=this.interactiveIframeId()===e,s=r?"auto":"hidden";o.documentElement&&(o.documentElement.style.overflow=s),o.body&&(o.body.style.overflow=s);let c=o.head?.querySelector("style[data-iframe-scroll]");if(c&&c.remove(),!r){let l=o.createElement("style");l.setAttribute("data-iframe-scroll","true"),l.textContent="::-webkit-scrollbar{display:none} html,body{overflow:hidden!important}",o.head?.appendChild(l)}}catch{}};i(),this.iframeScrollUpdateMap.set(n,i)}normalizeAngle180(t){let e=t%180;return e<0&&(e+=180),e}getCursorForHandle(t,e){let n=this.normalizeAngle180(t.rotation),i=n>=45&&n<=135,o=n<45||n>135;if(e.startsWith("scale-"))switch(e){case"scale-nw":case"scale-se":return o?"nwse-resize":"nesw-resize";case"scale-ne":case"scale-sw":return o?"nesw-resize":"nwse-resize";case"scale-w":case"scale-e":return i?"ns-resize":"ew-resize";case"scale-n":case"scale-s":return i?"ew-resize":"ns-resize"}return"move"}buildRotateCursorSvg(t){let e=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<g transform="rotate(${t} 12 12)">
<g clip-path="url(#clip0_325_17)">
<g filter="url(#filter0_d_325_17)">
<path d="M11 6C11.9193 6 12.8295 6.18106 13.6788 6.53284C14.5281 6.88463 15.2997 7.40024 15.9497 8.05025C16.5998 8.70026 17.1154 9.47194 17.4672 10.3212C17.8189 11.1705 18 12.0807 18 13V16H22L16 22L10 16H14V13C14 12.606 13.9224 12.2159 13.7716 11.8519C13.6209 11.488 13.3999 11.1573 13.1213 10.8787C12.8427 10.6001 12.512 10.3791 12.1481 10.2284C11.7841 10.0776 11.394 10 11 10H8V14L2 8L8 2V6H11Z" fill="white"/>
<path d="M11 9H7V11.5L3.5 8L7 4.5L7 7H11C11.7879 7 12.5682 7.15519 13.2961 7.45672C14.0241 7.75825 14.6855 8.20021 15.2426 8.75736C15.7998 9.31451 16.2418 9.97594 16.5433 10.7039C16.8448 11.4319 17 12.2121 17 13V17L19.5 17L16 20.5L12.5 17H15V13C15 12.4747 14.8965 11.9546 14.6955 11.4693C14.4945 10.984 14.1999 10.543 13.8284 10.1716C13.457 9.80014 13.016 9.5055 12.5307 9.30448C12.0454 9.10346 11.5253 9 11 9Z" fill="black"/>
</g>
</g>
<defs>
<filter id="filter0_d_325_17" x="0.2" y="1.2" width="23.6" height="23.6" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dy="1"/>
<feGaussianBlur stdDeviation="0.9"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.65 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_325_17"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_325_17" result="shape"/>
</filter>
<clipPath id="clip0_325_17">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>
</g>
</svg>`;return`url("data:image/svg+xml;utf8,${encodeURIComponent(e).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}") 12 12, auto`}getRotateCursor(t,e){let i={ne:0,nw:270,sw:180,se:90}[e]+t.rotation;return this.buildRotateCursorSvg(i)}scheduleHashUpdate(){if(O(this.platformId)){if(this.skipNextHashWrite){this.skipNextHashWrite=!1,this.hashDirty=!1;return}if(!this.readyForHashWrites){this.hashDirty=!0;return}if(this.suppressHash){this.hashDirty=!0;return}this.hashUpdateHandle&&window.clearTimeout(this.hashUpdateHandle),this.hashUpdateHandle=window.setTimeout(()=>{let t=this.serializeStateToHash(),e=t?`#${t}`:"";if(e!==this.lastSerializedHash){window.location.hash=e,this.lastSerializedHash=e;try{sessionStorage.setItem("canvasLastHash",e)}catch{}}this.hashDirty=!1,this.hashUpdateHandle=null},this.hashThrottleMs)}}serializeStateToHash(){let t=[];t.push(this.serializeCanvasSegment());for(let e of this.objects())t.push(this.serializeObjectSegment(e));return t.join("#")}serializeCanvasSegment(){let t=this.roundNumber(this.viewportX()),e=this.roundNumber(this.viewportY()),n=this.roundNumber(this.zoom());return`canvas/${t},${e},${n}`}serializeObjectSegment(t){let e=this.roundNumber(t.x),n=this.roundNumber(t.y),i=this.roundNumber(t.width/this.baseSize),o=this.roundNumber(t.rotation),r=t.width===0?1:t.height/t.width,s=[`type:${t.type}`,`ratio:${this.roundNumber(r)}`];return t.displayMode&&s.push(`mode:${t.displayMode}`),t.ogImage&&s.push(`og:${encodeURIComponent(t.ogImage)}`),`${encodeURIComponent(t.sourceRef)}/${e},${n},${i},${o}/${s.join(",")}`}applyHashState(t){if(!O(this.platformId)||!t||t.length<=1)return;let e=t.substring(1).split("#").filter(Boolean);if(e.length===0)return;let n=[],i=new Set,o=this.viewportX(),r=this.viewportY(),s=this.zoom();for(let c of e){let l=[];for(let y=0;y<c.length;y++)c[y]==="/"&&l.push(y);if(l.length<2)continue;let m="",f="",_="";for(let y=l.length-2;y>=0;y--){let Y=l[y],X=l[y+1];f=c.substring(Y+1,X);let rt=f.split(",");if(rt.length===4&&rt.every(Pt=>!Number.isNaN(parseFloat(Pt)))){_=c.substring(0,Y),m=c.substring(X+1);break}}if(!_||!_||!f)continue;let C=`${_}|${f}|${m??""}`;if(i.has(C))continue;i.add(C);let z=decodeURIComponent(_);if(z==="canvas"){let[y,Y,X]=f.split(",").map(parseFloat);Number.isNaN(y)||(o=y),Number.isNaN(Y)||(r=Y),Number.isNaN(X)||(s=Math.max(this.minZoom,Math.min(this.maxZoom,X)));continue}let[H,L,N,W]=f.split(",").map(parseFloat);if([H,L,N,W].some(y=>Number.isNaN(y)))continue;let E=this.parseFlags(m),J=E.get("ratio")??1,nt=typeof J=="number"?J:parseFloat(String(J)),it=Number.isNaN(nt)?1:nt,B=E.get("type")??"image",yt=E.get("mode")??"image",Ot=E.get("og")?decodeURIComponent(String(E.get("og"))):void 0,ot=this.baseSize*N,St=ot*it,A=this.resolveContent(z,B);if(!A)if(B==="image")A=this.transparentPixel;else continue;n.push({id:this.generateId(),type:B,x:H,y:L,width:ot,height:St,rotation:W,content:A,sourceRef:z,originalAspectRatio:it,safeUrl:B==="iframe"&&this.isValidUrl(A)?this.sanitizer.bypassSecurityTrustResourceUrl(A):void 0,ogImage:Ot,displayMode:yt})}this.viewportX.set(o),this.viewportY.set(r),this.zoom.set(s),this.objects.set(n),this.selectedObjectId.set(null),this.lastSerializedHash=t.startsWith("#")?t:`#${t}`;try{sessionStorage.setItem("canvasLastHash",this.lastSerializedHash)}catch{}!this.restoredFromHash&&n.length>0&&this.fitOnceAfterLoad();for(let c of n)c.type==="iframe"&&!c.ogImage&&this.isValidUrl(c.content)&&this.fetchOgImage(c.content,c.id)}resolveContent(t,e){if(t.startsWith("token:")){let i=t.substring(6);return this.readDataToken(i)??null}let n=this.readFileContent(t);return n||(e==="iframe"?this.isValidUrl(t)?t:null:t.startsWith("http://")||t.startsWith("https://")?t:null)}parseFlags(t){let e=new Map;if(!t)return e;for(let n of t.split(",")){let i=n.indexOf(":");if(i<=0)continue;let o=n.substring(0,i),r=n.substring(i+1);if(!o||r===void 0)continue;let s=parseFloat(r);e.set(o,Number.isNaN(s)?r:s)}return e}deriveSourceRef(t,e){if(!O(this.platformId))return t;if(t.startsWith("data:")){if(e){let i=this.makeFileKey(e);try{return localStorage.setItem(i,t),e}catch{}}return this.createDataToken(t)}return e??t}roundNumber(t){return Math.round(t*1e3)/1e3}createDataToken(t){let e=`${this.dataTokenPrefix}${Date.now()}-${Math.random().toString(36).slice(2,8)}`;try{localStorage.setItem(e,t)}catch{this.ephemeralTokens.set(e,t)}return`token:${e}`}readDataToken(t){try{let e=localStorage.getItem(t);if(e)return e}catch{}return this.ephemeralTokens.get(t)??null}makeFileKey(t){return`${this.dataFilePrefix}${t}`}readFileContent(t){let e=this.makeFileKey(t);try{return localStorage.getItem(e)}catch{return null}}generateId(){return"obj-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}cleanupObjectStorage(t){if(t.sourceRef&&!t.sourceRef.startsWith("token:")&&!t.sourceRef.startsWith("http")){let e=this.makeFileKey(t.sourceRef);try{localStorage.removeItem(e)}catch{}}else if(t.sourceRef?.startsWith("token:")){let e=t.sourceRef.substring(6);try{localStorage.removeItem(e)}catch{}this.ephemeralTokens.delete(e)}}cleanupOrphanedStorage(){if(O(this.platformId))try{let t=new Set;for(let n of this.objects())t.add(n.sourceRef);let e=[];for(let n=0;n<localStorage.length;n++){let i=localStorage.key(n);if(i){if(i.startsWith(this.dataTokenPrefix)){let o=`token:${i}`;t.has(o)||e.push(i)}else if(i.startsWith(this.dataFilePrefix)){let o=i.substring(this.dataFilePrefix.length);t.has(o)||e.push(i)}}}if(e.length>0)for(let n of e)localStorage.removeItem(n)}catch{}}async renderCompositionToBlob(){if(!O(this.platformId)||this.objects().length===0)return null;try{let t=this.calculateCompositionBounds();if(!t)return null;let e=1080,n=8,i=document.createElement("canvas");i.width=e,i.height=e;let o=i.getContext("2d");if(!o)return null;let r=e-2*n,s=r/t.width,c=r/t.height,l=Math.min(s,c),m=t.width*l,f=t.height*l,_=(e-m)/2,C=(e-f)/2;return await this.renderObjectsToCanvas(o,t,l,_,C),await new Promise(H=>{i.toBlob(H,"image/png")})}catch(t){return console.error("Error rendering composition:",t),null}}async shareComposition(){try{let t=await this.renderCompositionToBlob();if(!t)return;let e=navigator.canShare?.({files:[new File([],"probe",{type:"image/png"})]})??!1;if(navigator.share&&e){console.log("[Canvas] Share API available & canShare files, creating file...");let s={files:[new File([t],"composition.png",{type:"image/png"})]};console.log("[Canvas] Attempting to share with data:",s);try{await navigator.share(s),console.log("[Canvas] Share successful"),this.shareMenuOpen.set(!1);return}catch(c){let l=c instanceof Error?c.message:String(c);console.warn("[Canvas] Share failed, falling back:",l)}}else console.log("[Canvas] Share API not available or cannot share files; falling back to download");let n=URL.createObjectURL(t),i=document.createElement("a");i.href=n;let o=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);i.download=`composition-${o}.png`,i.click(),URL.revokeObjectURL(n),this.shareMenuOpen.set(!1)}catch(t){console.error("Error sharing composition:",t),this.shareMenuOpen.set(!1)}}async downloadImage(){try{let t=await this.renderCompositionToBlob();if(!t)return;if(this.isMobile()&&navigator.share){let r={files:[new File([t],"composition.png",{type:"image/png"})],title:"Composition"};try{await navigator.share(r);return}catch(s){console.log("Share cancelled or failed:",s)}}let e=URL.createObjectURL(t),n=document.createElement("a");n.href=e;let i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);n.download=`composition-${i}.png`,n.click(),URL.revokeObjectURL(e)}catch(t){console.error("Error downloading image:",t)}}async shareImage(){try{console.log("[Canvas] shareImage() called");let t=await this.renderCompositionToBlob();if(!t){console.error("[Canvas] No blob generated");return}console.log("[Canvas] Blob created, size:",t.size);let e=navigator.canShare?.({files:[new File([],"probe",{type:"image/png"})]})??!1;if(navigator.share&&e)try{console.log("[Canvas] navigator.share available and canShare files, attempting to share blob directly");let i=new File([t],"composition.png",{type:"image/png"});await navigator.share({files:[i],title:"My Composition"}),console.log("[Canvas] Share successful");return}catch(i){let o=i;console.warn("[Canvas] Direct share failed (falling back):",o?.name,o?.message)}else console.log("[Canvas] navigator.share not available or cannot share files; falling back");let n=URL.createObjectURL(t);if(console.log("[Canvas] Created blob URL:",n),window.parent!==window)console.log("[Canvas] In iframe, sending to parent for share handling"),window.parent.postMessage({type:"shareImage",blobUrl:n,filename:"composition.png"},"*");else{console.log("[Canvas] Not in iframe, downloading directly");let i=document.createElement("a");i.href=n;let o=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);i.download=`composition-${o}.png`,i.click(),URL.revokeObjectURL(n)}}catch(t){console.error("[Canvas] Error in shareImage:",t)}}calculateCompositionBounds(){let t=this.objects();if(t.length===0)return null;let e=1/0,n=1/0,i=-1/0,o=-1/0;for(let r of t){let s=this.getObjectCorners(r);for(let c of s)e=Math.min(e,c.x),n=Math.min(n,c.y),i=Math.max(i,c.x),o=Math.max(o,c.y)}return{x:e,y:n,width:i-e,height:o-n}}getObjectCorners(t){let e=t.x+t.width/2,n=t.y+t.height/2,i=t.rotation*Math.PI/180,o=Math.cos(i),r=Math.sin(i);return[{x:-t.width/2,y:-t.height/2},{x:t.width/2,y:-t.height/2},{x:t.width/2,y:t.height/2},{x:-t.width/2,y:t.height/2}].map(c=>({x:e+c.x*o-c.y*r,y:n+c.x*r+c.y*o}))}async renderObjectsToCanvas(t,e,n,i,o){for(let r of this.objects()){t.save();let s=r.x-e.x,c=r.y-e.y,l=i+(s+r.width/2)*n,m=o+(c+r.height/2)*n;t.translate(l,m),t.rotate(r.rotation*Math.PI/180);let f=r.width*n,_=r.height*n;if(r.type==="image")try{let C=await this.loadImage(r.content);t.drawImage(C,-f/2,-_/2,f,_)}catch(C){console.warn("Failed to load image:",C),t.fillStyle="#ddd",t.fillRect(-f/2,-_/2,f,_)}else if(r.type==="iframe")if(r.ogImage&&r.displayMode!=="iframe")try{let C=await this.loadImage(r.ogImage);t.drawImage(C,-f/2,-_/2,f,_)}catch(C){console.warn("Failed to load og:image:",C),t.fillStyle="#ddd",t.fillRect(-f/2,-_/2,f,_)}else t.fillStyle="#fff",t.strokeStyle="#007bff",t.lineWidth=2,t.fillRect(-f/2,-_/2,f,_),t.strokeRect(-f/2,-_/2,f,_),t.fillStyle="#333",t.font=`${Math.max(12,_*.1)}px sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText("Web Content",0,0);t.restore()}}loadImage(t){return new Promise((e,n)=>{let i=new Image;(t.startsWith("http://")||t.startsWith("https://"))&&(i.crossOrigin="anonymous"),i.onload=()=>e(i),i.onerror=()=>n(new Error("Failed to load image")),i.src=t})}static \u0275fac=function(e){return new(e||g)};static \u0275cmp=R({type:g,selectors:[["app-canvas"]],decls:33,vars:13,consts:[["fileInput",""],["urlInput",""],[1,"canvas-container",3,"click","mousedown","touchstart","drop","dragover"],[1,"dot-grid",3,"ngStyle"],[1,"canvas-objects",3,"ngStyle"],[1,"canvas-object",3,"selected","ngStyle"],[1,"close-button-container"],[1,"zoom-controls"],[1,"zoom-counter"],["title","Fit to view",1,"zoom-reset",3,"click"],["width","16","height","16","viewBox","0 0 16 16","fill","currentColor"],["d","M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"],[1,"share-controls"],[1,"download-button",3,"click","disabled"],[1,"share-menu-container"],[1,"share-button",3,"click","disabled"],["role","menu",1,"share-menu"],["type","file","accept","image/*",1,"visually-hidden-input",3,"change"],[1,"add-fab",3,"click"],["aria-haspopup","true","aria-label","Add content",1,"add-main",3,"click"],["role","menu",1,"add-menu"],[1,"share-fab",3,"click"],[1,"share-main",3,"click","disabled"],["width","20","height","20","viewBox","0 0 16 16","fill","currentColor"],["d","M13.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5zm-8.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm11 5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"],[1,"canvas-instructions"],[1,"url-modal-overlay"],[1,"canvas-object",3,"click","mousedown","touchstart","ngStyle"],[1,"hover-border",3,"ngStyle"],["alt","Canvas image",1,"object-content",3,"src"],["alt","URL preview",1,"object-content",3,"src"],[1,"iframe-wrapper"],["alt","URL preview",1,"object-content",3,"load","src"],[1,"iframe-wrapper",3,"mouseenter","mouseleave"],["sandbox","allow-scripts allow-same-origin allow-forms",1,"object-content",3,"load","src"],[1,"iframe-overlay"],[1,"iframe-overlay",3,"click"],[1,"iframe-overlay-message"],[1,"display-mode-toggle",3,"ngStyle"],[1,"selection-border",3,"ngStyle"],[1,"handle","handle-corner","handle-nw",3,"mousedown","touchstart","ngStyle"],[1,"handle","handle-corner","handle-ne",3,"mousedown","touchstart","ngStyle"],[1,"handle","handle-corner","handle-sw",3,"mousedown","touchstart","ngStyle"],[1,"handle","handle-corner","handle-se",3,"mousedown","touchstart","ngStyle"],[1,"handle","handle-edge","handle-w",3,"mousedown","touchstart","ngStyle"],[1,"handle","handle-edge","handle-e",3,"mousedown","touchstart","ngStyle"],[1,"handle","handle-edge","handle-n",3,"mousedown","touchstart","ngStyle"],[1,"handle","handle-edge","handle-s",3,"mousedown","touchstart","ngStyle"],[1,"rotation-indicator","rotation-nw",3,"mousedown","touchstart","ngStyle"],[1,"rotation-indicator","rotation-ne",3,"mousedown","touchstart","ngStyle"],[1,"rotation-indicator","rotation-sw",3,"mousedown","touchstart","ngStyle"],[1,"rotation-indicator","rotation-se",3,"mousedown","touchstart","ngStyle"],["title","Show as image",1,"toggle-btn",3,"click"],["d","M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"],["d","M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"],["title","Show as website",1,"toggle-btn",3,"click"],["d","M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4a9.267 9.267 0 0 1 .64-1.539 6.7 6.7 0 0 1 .597-.933A7.025 7.025 0 0 0 2.255 4H4.09zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958 0 0 0-.656 2.5h2.49zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5H4.847zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5H4.51zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12H5.145zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11a13.652 13.652 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5H3.82zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068H8.5zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5a6.959 6.959 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5h2.49zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4h2.355z"],["title","Return to URL wrapper",1,"close-button",3,"click"],["width","20","height","20","viewBox","0 0 20 20","fill","currentColor"],["d","M15 10l-1.5-1.5L9 13V3H7v10L2.5 8.5 1 10l6 6z"],["type","button",1,"share-menu-item",3,"click"],["role","menuitem",3,"click"],[1,"url-modal-overlay",3,"click"],[1,"url-modal",3,"click"],["type","url","placeholder","Paste URL here...",1,"url-input",3,"input","keydown.enter","keydown.escape","value"],[1,"url-modal-actions"],[1,"url-cancel",3,"click"],[1,"url-submit",3,"click"]],template:function(e,n){if(e&1){let i=T();p(0,"div",2),v("click",function(r){return d(i),h(n.onCanvasClick(r))})("mousedown",function(r){return d(i),h(n.onCanvasMouseDown(r))})("touchstart",function(r){return d(i),h(n.onCanvasTouchStart(r))})("drop",function(r){return d(i),h(n.onDrop(r))})("dragover",function(r){return d(i),h(n.onDragOver(r))}),j(1,"div",3),p(2,"div",4),st(3,Lt,5,6,"div",5,It),u(),I(5,Ut,4,0,"div",6),p(6,"div",7)(7,"div",8),M(8),u(),p(9,"button",9),v("click",function(){return d(i),h(n.fitToView())}),U(),p(10,"svg",10),j(11,"path",11),u()()(),G(),p(12,"div",12)(13,"button",13),v("click",function(){return d(i),h(n.downloadImage())}),M(14," Download "),u(),p(15,"div",14)(16,"button",15),v("click",function(){return d(i),h(n.shareMenuOpen.set(!n.shareMenuOpen()))}),M(17," Share "),u(),I(18,Rt,7,0,"div",16),u()(),p(19,"input",17,0),v("change",function(r){return d(i),h(n.onFileSelected(r))}),u(),p(21,"div",18),v("click",function(r){return d(i),h(r.stopPropagation())}),p(22,"button",19),v("click",function(){return d(i),h(n.toggleAddMenu())}),M(23," + "),u(),I(24,At,5,0,"div",20),u(),p(25,"div",21),v("click",function(r){return d(i),h(r.stopPropagation())}),p(26,"button",22),v("click",function(){return d(i),h(n.onShareClick())}),U(),p(27,"svg",23),j(28,"path",24),u()()(),G(),p(29,"div",25)(30,"p"),M(31),u()(),I(32,Yt,11,1,"div",26),u()}e&2&&(b(),w("ngStyle",n.getDotGridStyle()),b(),w("ngStyle",n.getCanvasObjectsStyle()),b(),ct(n.objects()),b(2),k(n.cameFromUrlWrapper()?5:-1),b(3),mt("",n.zoomPercentage(),"%"),b(5),w("disabled",n.objects().length===0),b(3),w("disabled",n.objects().length===0),b(2),k(n.shareMenuOpen()?18:-1),b(4),q("aria-expanded",n.addMenuOpen()?"true":"false"),b(2),k(n.addMenuOpen()?24:-1),b(2),w("disabled",n.objects().length===0),q("aria-label","Share"),b(5),ut(n.instructionsText()),b(),k(n.showUrlModal()?32:-1))},dependencies:[_t,vt],styles:['[_nghost-%COMP%]{display:block;width:100%;height:100%}.canvas-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;overflow:hidden;background-color:#121212;cursor:grab}.canvas-container[_ngcontent-%COMP%]:active{cursor:grabbing}.dot-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-image:radial-gradient(circle,rgba(255,255,255,.2) 1px,transparent 1px);background-size:20px 20px;background-position:0 0;pointer-events:none;z-index:1;transition:opacity .3s ease-in-out}.canvas-objects[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2;pointer-events:none}.canvas-object[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;cursor:move;-webkit-user-select:none;user-select:none;pointer-events:auto}.canvas-object.selected[_ngcontent-%COMP%]   .selection-border[_ngcontent-%COMP%]{display:block}.canvas-object[_ngcontent-%COMP%]   .object-content[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;pointer-events:none;display:block;border:none;position:relative;z-index:1}.canvas-object[_ngcontent-%COMP%]   .iframe-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.canvas-object[_ngcontent-%COMP%]   iframe.object-content[_ngcontent-%COMP%]{overflow:hidden;scrollbar-width:none;transition:opacity .2s ease-in-out}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.dimmed[_ngcontent-%COMP%]{opacity:.4}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]{pointer-events:auto;opacity:1;overflow:auto!important;scrollbar-width:auto}.canvas-object[_ngcontent-%COMP%]   iframe.object-content[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]::-webkit-scrollbar{display:block;width:12px;height:12px}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0000004d;border-radius:6px}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#0000001a}.canvas-object[_ngcontent-%COMP%]   .iframe-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000059;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1;pointer-events:auto}.canvas-object[_ngcontent-%COMP%]   .iframe-overlay[_ngcontent-%COMP%]   .iframe-overlay-message[_ngcontent-%COMP%]{background-color:#1e1e1ef2;color:#f0f0f0;padding:12px 24px;border-radius:8px;font-size:16px;font-weight:600;box-shadow:0 2px 12px #0006;-webkit-user-select:none;user-select:none;transition:transform .1s ease}.canvas-object[_ngcontent-%COMP%]   .iframe-overlay[_ngcontent-%COMP%]   .iframe-overlay-message[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.canvas-object[_ngcontent-%COMP%]   .selection-border[_ngcontent-%COMP%]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;border-style:solid;border-color:#007bff;border-width:calc(1px * var(--inverse-scale, 1));box-sizing:border-box;pointer-events:none;transform-origin:0 0}.canvas-object[_ngcontent-%COMP%]:hover   .selection-border[_ngcontent-%COMP%]{border-width:calc(3px * var(--inverse-scale, 1))}.canvas-object[_ngcontent-%COMP%]   .hover-border[_ngcontent-%COMP%]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;border-style:solid;border-color:#007bff;border-width:calc(1px * var(--inverse-scale, 1));box-sizing:border-box;pointer-events:none;transform-origin:0 0}.canvas-object[_ngcontent-%COMP%]:hover   .hover-border[_ngcontent-%COMP%]{display:block}.canvas-object[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{position:absolute;pointer-events:all;z-index:15;-webkit-user-select:none;user-select:none;transform-origin:center}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner[_ngcontent-%COMP%]{width:12px;height:12px;background-color:#007bff;border:1px solid white;box-sizing:border-box}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-nw[_ngcontent-%COMP%]{top:-6px;left:-6px;cursor:nwse-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-ne[_ngcontent-%COMP%]{top:-6px;right:-6px;cursor:nesw-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-sw[_ngcontent-%COMP%]{bottom:-6px;left:-6px;cursor:nesw-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-se[_ngcontent-%COMP%]{bottom:-6px;right:-6px;cursor:nwse-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:scale(1.3)}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge[_ngcontent-%COMP%]{background-color:transparent;border:none}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-w[_ngcontent-%COMP%]{top:0;left:-4px;width:8px;height:100%;cursor:w-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-e[_ngcontent-%COMP%]{top:0;right:-4px;width:8px;height:100%;cursor:e-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-n[_ngcontent-%COMP%]{top:-4px;left:0;width:100%;height:8px;cursor:n-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-s[_ngcontent-%COMP%]{bottom:-4px;left:0;width:100%;height:8px;cursor:s-resize}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]{position:absolute;transform-origin:center;width:20px;height:20px;pointer-events:all;z-index:15;cursor:grab}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]:hover{cursor:grab}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]:active{cursor:grabbing}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]:before{content:"";position:absolute;width:4px;height:4px;background-color:#28a745;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%)}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-nw[_ngcontent-%COMP%]{top:-30px;left:-30px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-ne[_ngcontent-%COMP%]{top:-30px;right:-30px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-sw[_ngcontent-%COMP%]{bottom:-30px;left:-30px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-se[_ngcontent-%COMP%]{bottom:-30px;right:-30px}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]{position:absolute;top:-50px;left:50%;transform:translate(-50%);transform-origin:center;display:flex;gap:4px;background-color:#1e1e1ef2;padding:4px;border-radius:6px;box-shadow:0 2px 8px #0006;pointer-events:all;z-index:20}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background-color:#1f1f1f;border:1px solid #3a3a3a;border-radius:4px;cursor:pointer;transition:all .2s;color:#cfcfcf;padding:0}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover{background-color:#2a2a2a;border-color:#5a5a5a;color:#fff}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;color:#fff}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}.canvas-instructions[_ngcontent-%COMP%]{position:absolute;top:20px;left:50%;transform:translate(-50%);background-color:#141414e6;padding:12px 24px;border-radius:8px;box-shadow:0 2px 8px #0006;z-index:100;pointer-events:none}.canvas-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#e6e6e6;font-size:14px;font-weight:500}.url-modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000b3;z-index:200;display:flex;align-items:center;justify-content:center;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.url-modal[_ngcontent-%COMP%]{background-color:#1e1e1efa;border:1px solid rgba(255,255,255,.2);border-radius:12px;padding:24px;max-width:500px;width:calc(100% - 40px);box-shadow:0 4px 20px #00000080}.url-modal[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;color:#fff;font-size:18px;font-weight:600}.url-input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;background-color:#0006;border:1px solid rgba(255,255,255,.2);border-radius:8px;color:#fff;font-size:14px;outline:none;transition:all .2s;box-sizing:border-box;-webkit-text-fill-color:#fff;background-clip:padding-box}.url-input[_ngcontent-%COMP%]::placeholder{color:#999}.url-input[_ngcontent-%COMP%]:focus{border-color:#fff6;background-color:#0009}.url-modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px;justify-content:flex-end}.url-modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;border:none;transition:all .2s}.url-cancel[_ngcontent-%COMP%]{background-color:#ffffff1a;color:#fff;border:1px solid rgba(255,255,255,.2)}.url-cancel[_ngcontent-%COMP%]:hover{background-color:#fff3}.url-submit[_ngcontent-%COMP%]{background-color:#ffffff26;color:#fff;border:1px solid rgba(255,255,255,.25)}.url-submit[_ngcontent-%COMP%]:hover{background-color:#ffffff40;border-color:#fff6}.close-button-container[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;z-index:100;pointer-events:auto}.close-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;padding:0;background-color:#141414f2;color:#e6e6e6;border:1px solid rgba(255,255,255,.1);border-radius:8px;cursor:pointer;box-shadow:0 2px 12px #00000080;transition:all .2s ease}.close-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;transform:rotate(180deg)}.close-button[_ngcontent-%COMP%]:hover{background-color:#1e1e1efa;border-color:#fff3;transform:translate(-2px);box-shadow:0 4px 16px #0009}.close-button[_ngcontent-%COMP%]:active{transform:translate(0);box-shadow:0 2px 8px #0006}.zoom-controls[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%);display:flex;align-items:center;gap:8px;background-color:#141414f2;padding:8px 16px;border-radius:8px;box-shadow:0 2px 12px #00000080;z-index:100;pointer-events:auto}.zoom-controls[_ngcontent-%COMP%]   .zoom-counter[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#e6e6e6;min-width:50px;text-align:center}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]{background-color:#000;color:#999;border:none;border-radius:4px;padding:6px 12px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;min-height:28px}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:block}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]:hover{background-color:#1a1a1a;color:#ccc}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]:active{background-color:#2a2a2a}.share-controls[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;display:flex;align-items:center;gap:8px;background-color:#141414f2;padding:8px 16px;border-radius:8px;box-shadow:0 2px 12px #00000080;z-index:100;pointer-events:auto}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%], .share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]{color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:13px;font-weight:500;cursor:pointer;transition:background-color .2s}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:disabled, .share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed;opacity:.6}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]{background-color:#007bff}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:active:not(:disabled){background-color:#004085}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]{position:relative}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]{background-color:#28a745}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#218838}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]:active:not(:disabled){background-color:#1e7e34}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]{position:absolute;bottom:100%;right:0;background-color:#1e1e1efa;border:1px solid rgba(255,255,255,.15);border-radius:8px;box-shadow:0 -4px 16px #0009;margin-bottom:8px;min-width:160px;overflow:hidden;z-index:101}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]   .share-menu-item[_ngcontent-%COMP%]{display:block;width:100%;text-align:left;color:#fff;border:none;background:none;padding:12px 16px;font-size:13px;cursor:pointer;transition:background-color .2s}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]   .share-menu-item[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]   .share-menu-item[_ngcontent-%COMP%]:active{background-color:#ffffff26}.share-controls[_ngcontent-%COMP%]   .share-menu-container[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]   .share-menu-item[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid rgba(255,255,255,.08)}.visually-hidden-input[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.add-fab[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;z-index:110;display:block}.add-fab[_ngcontent-%COMP%]   .add-main[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;background-color:#ffffff26;color:#fff;border:1px solid rgba(255,255,255,.25);box-shadow:0 2px 12px #00000080;cursor:pointer;font-size:24px;display:flex;align-items:center;justify-content:center;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:all .2s}.add-fab[_ngcontent-%COMP%]   .add-main[_ngcontent-%COMP%]:hover{background-color:#ffffff40;border-color:#fff6}.add-fab[_ngcontent-%COMP%]   .add-menu[_ngcontent-%COMP%]{position:absolute;bottom:68px;right:0;background:#1e1e1ef2;border:1px solid rgba(255,255,255,.2);border-radius:8px;box-shadow:0 2px 12px #00000080;padding:8px;display:flex;flex-direction:column;gap:6px;min-width:140px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.add-fab[_ngcontent-%COMP%]   .add-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#ffffff1a;color:#fff;border:1px solid rgba(255,255,255,.2);border-radius:6px;padding:10px 12px;font-size:14px;text-align:left;cursor:pointer;white-space:nowrap;transition:all .2s}.add-fab[_ngcontent-%COMP%]   .add-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#fff3;border-color:#fff6}.share-fab[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;z-index:110;display:block}.share-fab[_ngcontent-%COMP%]   .share-main[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;background-color:#ffffff26;color:#fff;border:1px solid rgba(255,255,255,.25);box-shadow:0 2px 12px #00000080;cursor:pointer;display:flex;align-items:center;justify-content:center;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:all .2s}.share-fab[_ngcontent-%COMP%]   .share-main[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#ffffff40;border-color:#fff6}.share-fab[_ngcontent-%COMP%]   .share-main[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.share-fab[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]{position:absolute;bottom:68px;left:0;background:#1e1e1ef2;border:1px solid rgba(255,255,255,.2);border-radius:8px;box-shadow:0 2px 12px #00000080;padding:8px;display:flex;flex-direction:column;gap:6px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.share-fab[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#ffffff1a;color:#fff;border:1px solid rgba(255,255,255,.2);border-radius:6px;padding:10px 12px;font-size:14px;text-align:left;cursor:pointer;transition:all .2s}.share-fab[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#fff3;border-color:#fff6}.share-fab[_ngcontent-%COMP%]   .share-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}@media(max-width:768px){.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner[_ngcontent-%COMP%]{width:20px;height:20px}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-nw[_ngcontent-%COMP%]{top:-10px;left:-10px}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-ne[_ngcontent-%COMP%]{top:-10px;right:-10px}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-sw[_ngcontent-%COMP%]{bottom:-10px;left:-10px}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-se[_ngcontent-%COMP%]{bottom:-10px;right:-10px}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-w[_ngcontent-%COMP%], .canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-e[_ngcontent-%COMP%]{width:16px;left:-8px}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-e[_ngcontent-%COMP%]{right:-8px;left:auto}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-n[_ngcontent-%COMP%], .canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-s[_ngcontent-%COMP%]{height:16px;top:-8px}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-s[_ngcontent-%COMP%]{bottom:-8px;top:auto}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]{width:32px;height:32px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]:before{width:8px;height:8px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-nw[_ngcontent-%COMP%]{top:-40px;left:-40px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-ne[_ngcontent-%COMP%]{top:-40px;right:-40px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-sw[_ngcontent-%COMP%]{bottom:-40px;left:-40px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-se[_ngcontent-%COMP%]{bottom:-40px;right:-40px}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]{top:-60px;padding:6px;gap:6px}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{width:44px;height:44px}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.canvas-instructions[_ngcontent-%COMP%]{top:12px;left:12px;right:12px;transform:none;padding:10px 16px}.canvas-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;line-height:1.4;text-align:center}.zoom-controls[_ngcontent-%COMP%]{bottom:16px;padding:10px 16px;gap:12px}.zoom-controls[_ngcontent-%COMP%]   .zoom-counter[_ngcontent-%COMP%]{font-size:16px;min-width:60px}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]{padding:10px 16px;font-size:14px;min-height:44px}.share-controls[_ngcontent-%COMP%]{bottom:80px;right:16px;flex-direction:column;padding:10px;gap:8px}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%], .share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]{padding:12px 20px;font-size:14px;min-height:44px;min-width:100px}.add-fab[_ngcontent-%COMP%], .share-fab[_ngcontent-%COMP%]{display:block}.share-controls[_ngcontent-%COMP%]{display:none}}@media(max-width:375px){.canvas-instructions[_ngcontent-%COMP%]{top:8px;left:8px;right:8px;padding:8px 12px}.canvas-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px}.zoom-controls[_ngcontent-%COMP%]{bottom:12px;padding:8px 12px}.share-controls[_ngcontent-%COMP%]{bottom:70px;right:12px}}'],changeDetection:0})};var Mt=class g{title=x("sample-reflect");static \u0275fac=function(e){return new(e||g)};static \u0275cmp=R({type:g,selectors:[["app-root"]],decls:3,vars:1,consts:[[3,"fullScreen"]],template:function(e,n){e&1&&(p(0,"lib-layout",0),j(1,"app-canvas")(2,"router-outlet"),u()),e&2&&w("fullScreen",!0)},dependencies:[wt,xt,Q],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})};export{Mt as App};
