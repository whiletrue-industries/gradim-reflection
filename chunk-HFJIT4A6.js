import{Ba as b,Da as _,Ea as x,J as a,P as p,Va as U,Wa as v,X as s,Za as y,aa as d,ca as u,da as m,ia as f,pa as h,qa as g,xa as i,ya as w,za as l}from"./chunk-NJ4HO3WV.js";var R="https://gradim-wall.netlify.app",P="https://gradim.fh-potsdam.de/omeka-s/api/items?per_page=1&sort_by=random",A=`${P}&fields[]=dcterms:identifier`;async function M(){if(typeof fetch>"u")return null;try{let r=await C(A)??await C(P);return r?`${R}/${r}`:null}catch{return null}}async function C(r){let t=await fetch(r,{headers:{Accept:"application/json"}});if(!t.ok)return null;let e=await t.json();if(!Array.isArray(e)||e.length===0)return null;let n=e[0]?.["dcterms:identifier"]?.[0]?.["@value"];return typeof n=="string"?n:null}function S(r,t){if(r&1&&l(0,"iframe",1),r&2){let e=x();b("src",e.safeContextUrl(),u)}}var O=class r{sanitizer=a(y);platformId=a(d);isBrowser=v(this.platformId);currentUrl=s("");safeContextUrl=s(null);constructor(){let t=this.getWallUrlFromLocation();t&&this.setUrl(t),this.isBrowser&&!t&&this.loadRandomUrlFromApi()}shareToCanvas(){let t=this.getWallUrlFromLocation()??this.currentUrl();if(!t)return;let{protocol:e,hostname:n,port:c}=window.location,L=n==="localhost"||n==="127.0.0.1"||n==="::1",o;if(L){let k="4201";o=new URL(`http://${n}:${k}/`)}else o=new URL("sample-reflect/",window.location.href);o.searchParams.set("shareUrl",t),this.getWallUrlFromLocation()||window.history.replaceState(null,"",`?wallUrl=${encodeURIComponent(t)}`),window.location.href=o.toString()}getWallUrlFromLocation(){if(!this.isBrowser)return null;try{return new URLSearchParams(window.location.search).get("wallUrl")||null}catch{return null}}setUrl(t){t&&(this.currentUrl.set(t),this.safeContextUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(t)))}async loadRandomUrlFromApi(){let t=await M();t&&this.setUrl(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=f({type:r,selectors:[["app-url-wrapper"]],decls:6,vars:1,consts:[[1,"url-wrapper-container"],["title","Context View","allow","publickey-credentials-create *; publickey-credentials-get *","sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-downloads",1,"wrapped-iframe",3,"src"],[1,"share-button-container"],["type","button","title","Share to canvas",1,"share-button",3,"click","touchstart"],["width","20","height","20","viewBox","0 0 24 24","fill","currentColor"],["d","M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"]],template:function(e,n){e&1&&(i(0,"div",0),h(1,S,1,1,"iframe",1),i(2,"div",2)(3,"button",3),_("click",function(){return n.shareToCanvas()})("touchstart",function(){return n.shareToCanvas()}),p(),i(4,"svg",4),l(5,"path",5),w()()()()),e&2&&(m(),g(n.safeContextUrl()?1:-1))},dependencies:[U],styles:[".url-wrapper-container[_ngcontent-%COMP%]{position:fixed;inset:0;width:100%;height:100%;overflow:hidden;background:#000}.wrapped-iframe[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;border:none;display:block;z-index:1}.share-button-container[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;z-index:200;pointer-events:auto;display:flex;gap:8px;align-items:center}.button-group[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.share-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;padding:0;background-color:#141414f2;color:#e6e6e6;border:1px solid rgba(255,255,255,.1);border-radius:8px;cursor:pointer;box-shadow:0 2px 12px #00000080;transition:all .2s ease;touch-action:manipulation;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;user-select:none}.share-button[_ngcontent-%COMP%]:hover{background-color:#1e1e1efa;border-color:#fff3;transform:translateY(-2px);box-shadow:0 4px 16px #0009}.share-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #0006}.share-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.share-button.close[_ngcontent-%COMP%]{background-color:#1e1e1ef2}.share-button.saved[_ngcontent-%COMP%]{background-color:#287850e6;border-color:#64c8964d}.share-button.saved[_ngcontent-%COMP%]:hover{background-color:#328c64fa;border-color:#96ffc866}.canvas-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;width:100%;height:100%;z-index:10;background:#0000000d;overflow:hidden}.canvas-overlay.slide-in-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideFromLeft .36s ease-in-out}.canvas-overlay.slide-out-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideToLeft .36s ease-in-out}.canvas-iframe[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;border:none;display:block;box-shadow:0 0 30px #0000004d}@keyframes _ngcontent-%COMP%_slideFromLeft{0%{clip-path:inset(0 100% 0 0)}to{clip-path:inset(0 0 0 0)}}@keyframes _ngcontent-%COMP%_slideToLeft{0%{clip-path:inset(0 0 0 0)}to{clip-path:inset(0 100% 0 0)}}"],changeDetection:0})};export{O as UrlWrapper};
