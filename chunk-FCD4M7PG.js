import{A as v,B as s,C,D as R,E as P,G as re,H as k,I as ae,J as se,K as S,M as ce,P as le,R as de,a as M,b as j,c as N,d as b,e as _,f as X,g as Q,i as x,j as Y,k as J,l as W,m as ee,n as h,o as te,p as F,q as ne,r as I,s as z,t as ie,u as oe,v as m,w as d,x as p,y as O,z as H}from"./chunk-2F5CESVE.js";var fe=(g,e)=>e.id;function be(g,e){if(g&1&&O(0,"img",13),g&2){let t=s().$implicit;m("src",t.content,W)}}function _e(g,e){if(g&1&&O(0,"img",14),g&2){let t=s(2).$implicit;m("src",t.ogImage,W)}}function we(g,e){if(g&1){let t=H();d(0,"div",19),v("click",function(i){b(t);let o=s(3).$implicit,r=s();return _(r.onIframeOverlayClick(i,o.id))}),d(1,"div",20),P(2," Click to interact "),p()()}}function Ce(g,e){if(g&1){let t=H();d(0,"div",16),v("mouseenter",function(){b(t);let i=s(2).$implicit,o=s();return _(o.onIframeMouseEnter(i.id))})("mouseleave",function(){b(t);let i=s(2).$implicit,o=s();return _(o.onIframeMouseLeave(i.id))}),d(1,"iframe",17),v("load",function(i){b(t);let o=s(2).$implicit,r=s();return _(r.onIframeLoad(i,o.id))}),p(),I(2,we,3,0,"div",18),p()}if(g&2){let t=s(2).$implicit,n=s();h(),R("dimmed",n.hoveredIframeId()===t.id)("interactive",n.interactiveIframeId()===t.id),m("src",t.safeUrl||t.content,ee),ne("scrolling",n.interactiveIframeId()===t.id?"yes":"no"),h(),z(n.hoveredIframeId()===t.id&&n.interactiveIframeId()!==t.id?2:-1)}}function ye(g,e){if(g&1&&I(0,_e,1,1,"img",14)(1,Ce,3,7,"div",15),g&2){let t=s().$implicit;z(t.displayMode==="image"&&t.ogImage?0:1)}}function xe(g,e){if(g&1){let t=H();d(0,"div",21)(1,"button",35),v("click",function(){b(t);let i=s(2).$implicit,o=s();return _(o.toggleDisplayMode(i.id))}),X(),d(2,"svg",36),O(3,"path",37)(4,"path",38),p()(),Q(),d(5,"button",39),v("click",function(){b(t);let i=s(2).$implicit,o=s();return _(o.toggleDisplayMode(i.id))}),X(),d(6,"svg",36),O(7,"path",40),p()()()}if(g&2){let t=s(2).$implicit,n=s();m("ngStyle",n.getInverseScaleStyle(t)),h(),R("active",t.displayMode==="image"),h(4),R("active",t.displayMode==="iframe")}}function Oe(g,e){if(g&1){let t=H();I(0,xe,8,5,"div",21),O(1,"div",22),d(2,"div",23),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-nw"))}),p(),d(3,"div",24),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-ne"))}),p(),d(4,"div",25),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-sw"))}),p(),d(5,"div",26),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-se"))}),p(),d(6,"div",27),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-w"))}),p(),d(7,"div",28),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-e"))}),p(),d(8,"div",29),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-n"))}),p(),d(9,"div",30),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"scale-s"))}),p(),d(10,"div",31),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"rotate-nw"))}),p(),d(11,"div",32),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"rotate-ne"))}),p(),d(12,"div",33),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"rotate-sw"))}),p(),d(13,"div",34),v("mousedown",function(i){b(t);let o=s().$implicit,r=s();return _(r.onHandleMouseDown(i,o.id,"rotate-se"))}),p()}if(g&2){let t=s().$implicit,n=s();z(t.type==="iframe"&&t.ogImage?0:-1),h(),m("ngStyle",n.getSelectionBorderStyle()),h(),C("cursor",n.getCursorForHandle(t,"scale-nw")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getCursorForHandle(t,"scale-ne")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getCursorForHandle(t,"scale-sw")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getCursorForHandle(t,"scale-se")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getCursorForHandle(t,"scale-w")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getCursorForHandle(t,"scale-e")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getCursorForHandle(t,"scale-n")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getCursorForHandle(t,"scale-s")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getRotateCursor(t,"nw")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getRotateCursor(t,"ne")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getRotateCursor(t,"sw")),m("ngStyle",n.getInverseScaleStyle(t)),h(),C("cursor",n.getRotateCursor(t,"se")),m("ngStyle",n.getInverseScaleStyle(t))}}function Me(g,e){if(g&1){let t=H();d(0,"div",11),v("click",function(i){let o=b(t).$implicit,r=s();return _(r.onObjectClick(i,o.id))})("mousedown",function(i){let o=b(t).$implicit,r=s();return _(r.onObjectMouseDown(i,o.id))}),O(1,"div",12),I(2,be,1,1,"img",13)(3,ye,2,1),I(4,Oe,14,38),p()}if(g&2){let t=e.$implicit,n=s();R("selected",n.selectedObjectId()===t.id),m("ngStyle",n.getObjectStyle(t)),h(),m("ngStyle",n.getSelectionBorderStyle()),h(),z(t.type==="image"?2:t.type==="iframe"?3:-1),h(2),z(n.selectedObjectId()===t.id?4:-1)}}var L=class g{platformId=N(J);sanitizer=N(ce);baseSize=200;dataTokenPrefix="data-token-";dataFilePrefix="file-data-";hashUpdateHandle=null;hashThrottleMs=80;lastSerializedHash="";suppressHash=!1;hashDirty=!1;wheelFlushHandle=null;ephemeralTokens=new Map;transparentPixel="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMB/hsrLxkAAAAASUVORK5CYII=";objects=x([]);selectedObjectId=x(null);selectedObject=k(()=>{let e=this.selectedObjectId();return e?this.objects().find(t=>t.id===e):null});viewportX=x(0);viewportY=x(0);zoom=x(1);hoveredIframeId=x(null);interactiveIframeId=x(null);hoverTimeoutHandle=null;iframeScrollUpdateMap=new WeakMap;baseGridSize=20;gridScaleLevels=[.25,.5,1,2,4,8,16];minVisibleGridSize=8;maxVisibleGridSize=50;gridScale=x(1);gridSize=k(()=>this.baseGridSize*this.gridScale());apparentGridSize=k(()=>this.gridSize()*this.zoom());gridOpacity=k(()=>{let e=this.apparentGridSize();return e<this.minVisibleGridSize?Math.max(0,e/this.minVisibleGridSize):e>this.maxVisibleGridSize?Math.max(0,1-(e-this.maxVisibleGridSize)/(this.maxVisibleGridSize*.5)):1});zoomPercentage=k(()=>Math.round(this.zoom()*100));isDragging=!1;isTransforming=!1;isPanningCanvas=!1;dragStartX=0;dragStartY=0;transformStartX=0;transformStartY=0;transformHandle=null;originalObject=null;panStartViewportX=0;panStartViewportY=0;rotateStartAngle=0;rotateStartRotation=0;transformHandles=[{type:"scale-nw",cursor:"nw-resize"},{type:"scale-ne",cursor:"ne-resize"},{type:"scale-sw",cursor:"sw-resize"},{type:"scale-se",cursor:"se-resize"},{type:"scale-w",cursor:"w-resize"},{type:"scale-e",cursor:"e-resize"},{type:"scale-n",cursor:"n-resize"},{type:"scale-s",cursor:"s-resize"},{type:"rotate",cursor:"grab"}];constructor(){if(S(this.platformId)){this.setupEventListeners(),window.addEventListener("hashchange",this.onHashChange),window.addEventListener("keydown",t=>this.onKeyDown(t)),Y(()=>{this.viewportX(),this.viewportY(),this.zoom(),this.objects(),this.scheduleHashUpdate()}),Y(()=>{let t=this.zoom();this.updateGridScale(t)});let e="";try{let t=sessionStorage.getItem("canvasLastHash");console.log("[Canvas] Constructor - storedHash:",t),t?(e=t.startsWith("#")?t:`#${t}`,console.log("[Canvas] Constructor - using hash from sessionStorage:",e)):(e=window.location.hash,console.log("[Canvas] Constructor - using hash from window.location:",e)),e&&e!==window.location.hash&&window.history.replaceState(null,"",e)}catch(t){console.error("[Canvas] Constructor - error accessing sessionStorage:",t),e=window.location.hash}this.suppressHash=!0,console.log("[Canvas] Constructor - applying hash state:",e),this.applyHashState(e),this.suppressHash=!1,te(()=>{console.log("[Canvas] afterNextRender - window.location.hash:",window.location.hash);try{let t=sessionStorage.getItem("canvasLastHash");if(console.log("[Canvas] afterNextRender - storedHash:",t),t&&!window.location.hash){let n=t.startsWith("#")?t:`#${t}`;console.log("[Canvas] afterNextRender - restoring hash:",n),window.history.replaceState(null,"",n),this.suppressHash=!0,this.applyHashState(n),this.suppressHash=!1}}catch(t){console.error("[Canvas] afterNextRender - error:",t)}})}}onHashChange=()=>{S(this.platformId)&&window.location.hash!==this.lastSerializedHash&&(this.applyHashState(window.location.hash),this.lastSerializedHash=window.location.hash)};setupEventListeners(){window.addEventListener("paste",e=>this.onPaste(e)),window.addEventListener("dragover",e=>e.preventDefault()),window.addEventListener("wheel",e=>this.onWheel(e),{passive:!1})}onDrop(e){e.preventDefault(),e.stopPropagation();let t=e.dataTransfer?.files;if(t&&t.length>0){let n=t[0];if(n.type.startsWith("image/")){let i=new FileReader;i.onload=()=>{let o=e.currentTarget,r=o?o.getBoundingClientRect():{left:0,top:0},a=e.clientX-r.left-this.viewportX(),c=e.clientY-r.top-this.viewportY(),l=i.result,w=this.deriveSourceRef(l,n.name),u=new Image;u.onload=()=>{let f=u.naturalHeight/u.naturalWidth||1;this.addObject({id:this.generateId(),type:"image",x:a/this.zoom(),y:c/this.zoom(),width:this.baseSize,height:this.baseSize*f,rotation:0,content:l,sourceRef:w,originalAspectRatio:f})},u.onerror=()=>{this.addObject({id:this.generateId(),type:"image",x:a/this.zoom(),y:c/this.zoom(),width:this.baseSize,height:this.baseSize,rotation:0,content:l,sourceRef:w,originalAspectRatio:1})},u.src=l},i.readAsDataURL(n)}}}onDragOver(e){e.preventDefault(),e.stopPropagation()}onPaste(e){let t=e.clipboardData?.getData("text");if(t&&this.isValidUrl(t)){let n=this.deriveSourceRef(t),i={id:this.generateId(),type:"iframe",x:(window.innerWidth/2-this.viewportX())/this.zoom(),y:(window.innerHeight/2-this.viewportY())/this.zoom(),width:600,height:400,rotation:0,content:t,sourceRef:n,originalAspectRatio:400/600,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(t),displayMode:"image"};this.addObject(i),this.fetchOgImage(t,i.id),e.preventDefault()}}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}async fetchOgImage(e,t){if(!S(this.platformId))return;let n=!1;try{let i=`/api/url-metadata?url=${encodeURIComponent(e)}`;console.log("[Canvas] fetchOgImage: calling",i);let o=await fetch(i);console.log("[Canvas] fetchOgImage: response status",o.status,o.statusText);let r=o.headers.get("content-type");if(console.log("[Canvas] fetchOgImage: content-type",r),o.ok&&r?.includes("application/json")){let a=await o.json();console.log("[Canvas] fetchOgImage: received data:",a),a.ogImage?(console.log("[Canvas] fetchOgImage: setting og:image:",a.ogImage),this.updateObjectOgImage(t,a.ogImage),n=!0):console.log("[Canvas] fetchOgImage: no ogImage in response")}else console.log("[Canvas] fetchOgImage: not OK or not JSON, falling back to dev mode")}catch(i){console.log("[Canvas] fetchOgImage: fetch failed, will try fallback:",i)}n||(console.log("[Canvas] fetchOgImage: no og:image from API, trying dev fallback"),this.trySetDevelopmentOgImage(e,t))}trySetDevelopmentOgImage(e,t){try{let n=new URL(e),i=n.hostname.toLowerCase(),r={"github.com":"https://github.githubassets.com/images/modules/site/social-cards/github-social.png","www.github.com":"https://github.githubassets.com/images/modules/site/social-cards/github-social.png","youtube.com":"https://www.youtube.com/img/desktop/yt_1200.png","www.youtube.com":"https://www.youtube.com/img/desktop/yt_1200.png"}[i];if(!r&&i==="gradim-wall.netlify.app"){let a=n.pathname.split("/").filter(Boolean),c=decodeURIComponent(a[a.length-1]||"");c&&/^[A-Za-z0-9_\-]+$/.test(c)&&(r=`https://gradim.fh-potsdam.de/omeka-s/files/large/${c}.jpg`)}r?(console.log("[Canvas] trySetDevelopmentOgImage: using hardcoded/heuristic og:image for",i,":",r),setTimeout(()=>{this.updateObjectOgImage(t,r)},500)):console.log("[Canvas] trySetDevelopmentOgImage: no hardcoded og:image for",i,"- API endpoint (/api/url-metadata) is required to fetch og:image for arbitrary URLs")}catch(n){console.error("[Canvas] trySetDevelopmentOgImage: error:",n)}}extractOgImage(e){let t=e.match(/<meta[^>]*property=["']og:image["'][^>]*content=["']([^"']*)["'][^>]*>/i)||e.match(/<meta[^>]*content=["']([^"']*)["'][^>]*property=["']og:image["'][^>]*>/i);return t?t[1]:null}updateObjectOgImage(e,t){let n=new Image;n.onload=()=>{let i=n.naturalHeight/n.naturalWidth||1,o=600,r=o*i;this.objects.update(a=>a.map(c=>c.id===e?j(M({},c),{ogImage:t,width:o,height:r,originalAspectRatio:i}):c)),this.scheduleHashUpdate()},n.onerror=()=>{this.objects.update(i=>i.map(o=>o.id===e?j(M({},o),{ogImage:t}):o))},n.src=t}toggleDisplayMode(e){let t=this.objects().find(i=>i.id===e);if(!t||t.type!=="iframe"||!t.ogImage)return;let n=t.displayMode==="iframe"?"image":"iframe";this.objects.update(i=>i.map(o=>o.id===e?j(M({},o),{displayMode:n}):o)),this.scheduleHashUpdate()}setOgImageForTesting(e){if(!this.isValidUrl(e)){console.error("Invalid URL format:",e);return}let t=this.selectedObjectId();if(!t){console.warn("No object selected. Please select an iframe object first.");return}let n=this.objects().find(i=>i.id===t);if(!n||n.type!=="iframe"){console.warn("Selected object is not an iframe.");return}this.updateObjectOgImage(t,e),console.log("og:image set to:",e,"- toggle buttons should now be visible")}addObject(e){this.objects.update(t=>[...t,e]),this.selectedObjectId.set(e.id),this.scheduleHashUpdate()}onKeyDown(e){if(e.key!=="Backspace")return;let t=e.target;if(t&&(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable))return;let n=this.selectedObjectId();if(!n)return;e.preventDefault(),this.suppressHash=!0;let i=this.objects().find(o=>o.id===n);i&&this.cleanupObjectStorage(i),this.objects.update(o=>o.filter(r=>r.id!==n)),this.selectedObjectId.set(null),this.scheduleHashUpdate()}onObjectClick(e,t){e.stopPropagation(),this.selectedObjectId.set(t),(this.objects().find(i=>i.id===t)?.type!=="iframe"||this.interactiveIframeId()!==t)&&(this.interactiveIframeId.set(null),this.updateAllIframeScrollStates())}onCanvasClick(e){let t=e.target,n=t===e.currentTarget||t.classList.contains("dot-grid")||t.classList.contains("canvas-objects");this.hashDirty&&this.scheduleHashUpdate(),n&&(this.selectedObjectId.set(null),this.interactiveIframeId.set(null),this.updateAllIframeScrollStates())}onCanvasMouseDown(e){if(e.target===e.currentTarget||e.target.classList.contains("dot-grid")){this.suppressHash=!0,this.selectedObjectId.set(null),this.isPanningCanvas=!0,this.dragStartX=e.clientX,this.dragStartY=e.clientY,this.panStartViewportX=this.viewportX(),this.panStartViewportY=this.viewportY();let t=i=>{if(!this.isPanningCanvas)return;let o=i.clientX-this.dragStartX,r=i.clientY-this.dragStartY;this.viewportX.set(this.panStartViewportX+o),this.viewportY.set(this.panStartViewportY+r)},n=()=>{this.isPanningCanvas=!1,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n)};window.addEventListener("mousemove",t),window.addEventListener("mouseup",n)}}onObjectMouseMove(e,t){}onObjectMouseLeave(e){}updateAllIframeScrollStates(){setTimeout(()=>{document.querySelectorAll("iframe.object-content").forEach(t=>{let n=t,i=this.iframeScrollUpdateMap.get(n);i&&i()})},0)}clearHoverTimeout(){this.hoverTimeoutHandle&&(clearTimeout(this.hoverTimeoutHandle),this.hoverTimeoutHandle=null)}onIframeMouseEnter(e){this.clearHoverTimeout(),this.hoverTimeoutHandle=setTimeout(()=>{this.interactiveIframeId()!==e&&this.hoveredIframeId.set(e)},500)}onIframeMouseLeave(e){this.clearHoverTimeout(),this.hoveredIframeId()===e&&this.hoveredIframeId.set(null)}onIframeOverlayClick(e,t){e.stopPropagation(),this.interactiveIframeId.set(t),this.hoveredIframeId.set(null),this.clearHoverTimeout(),this.updateAllIframeScrollStates()}updateGridScale(e){let t=this.gridScaleLevels[0],n=1/0;for(let i of this.gridScaleLevels){let o=this.baseGridSize*i*e,r=(this.minVisibleGridSize+this.maxVisibleGridSize)/2,a=Math.abs(o-r);a<n&&(n=a,t=i)}this.gridScale.set(t)}resetZoom(){this.zoom.set(1),this.viewportX.set(0),this.viewportY.set(0)}onWheel(e){e.preventDefault(),this.suppressHash=!0;let n=e.deltaY>0?.9:1.1,i=Math.max(.1,Math.min(5,this.zoom()*n)),o=e.clientX,r=e.clientY,a=(o-this.viewportX())/this.zoom(),c=(r-this.viewportY())/this.zoom();this.zoom.set(i),this.viewportX.set(o-a*i),this.viewportY.set(r-c*i),this.wheelFlushHandle&&window.clearTimeout(this.wheelFlushHandle),this.wheelFlushHandle=window.setTimeout(()=>{this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),this.wheelFlushHandle=null},150)}onObjectMouseDown(e,t){e.preventDefault(),e.stopPropagation();let n=this.objects().find(r=>r.id===t);if(!n)return;this.isDragging=!0,this.suppressHash=!0,this.dragStartX=e.clientX,this.dragStartY=e.clientY,this.originalObject=M({},n),this.selectedObjectId.set(t);let i=r=>{if(!this.isDragging||!this.originalObject)return;let a=(r.clientX-this.dragStartX)/this.zoom(),c=(r.clientY-this.dragStartY)/this.zoom();this.objects.update(l=>l.map(w=>w.id===t?j(M({},w),{x:this.originalObject.x+a,y:this.originalObject.y+c}):w))},o=()=>{this.isDragging=!1,this.originalObject=null,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",i),window.addEventListener("mouseup",o)}onHandleMouseDown(e,t,n){e.preventDefault(),e.stopPropagation();let i=this.objects().find(a=>a.id===t);if(!i)return;this.isTransforming=!0,this.suppressHash=!0,this.transformStartX=e.clientX,this.transformStartY=e.clientY,this.transformHandle=n,this.originalObject=M({},i),this.rotateStartRotation=i.rotation,this.rotateStartAngle=this.getPointerAngle(i,e.clientX,e.clientY);let o=a=>{if(!this.isTransforming||!this.originalObject)return;let c=(a.clientX-this.transformStartX)/this.zoom(),l=(a.clientY-this.transformStartY)/this.zoom();this.transformHandle?.startsWith("rotate-")?this.handleRotate(t,a.clientX,a.clientY):this.transformHandle==="rotate"?this.handleRotate(t,a.clientX,a.clientY):this.transformHandle?.startsWith("scale-")&&this.handleScale(t,c,l,this.transformHandle)},r=()=>{this.isTransforming=!1,this.originalObject=null,this.transformHandle=null,this.suppressHash=!1,this.hashDirty&&this.scheduleHashUpdate(),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",r)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",r)}handleScale(e,t,n,i){if(!this.originalObject)return;let o=this.originalObject.width,r=this.originalObject.height,a=0,c=0;if(i==="scale-nw"){let l=(-t-n)/2;o=Math.max(50,this.originalObject.width+l),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:Math.max(50,this.originalObject.height+l),a=this.originalObject.width-o,c=this.originalObject.height-r}else if(i==="scale-ne"){let l=(t-n)/2;o=Math.max(50,this.originalObject.width+l),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:Math.max(50,this.originalObject.height+l),c=this.originalObject.height-r}else if(i==="scale-sw"){let l=(-t+n)/2;o=Math.max(50,this.originalObject.width+l),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:Math.max(50,this.originalObject.height+l),a=this.originalObject.width-o}else if(i==="scale-se"){let l=(t+n)/2;o=Math.max(50,this.originalObject.width+l),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:Math.max(50,this.originalObject.height+l)}else i==="scale-w"?(o=Math.max(50,this.originalObject.width-t),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:this.originalObject.height,a=this.originalObject.width-o,this.originalObject.type==="image"&&(c=(this.originalObject.height-r)/2)):i==="scale-e"?(o=Math.max(50,this.originalObject.width+t),r=this.originalObject.type==="image"?o*this.originalObject.originalAspectRatio:this.originalObject.height,this.originalObject.type==="image"&&(c=(this.originalObject.height-r)/2)):i==="scale-n"?(r=Math.max(50,this.originalObject.height-n),o=this.originalObject.type==="image"?r/this.originalObject.originalAspectRatio:this.originalObject.width,c=this.originalObject.height-r,this.originalObject.type==="image"&&(a=(this.originalObject.width-o)/2)):i==="scale-s"&&(r=Math.max(50,this.originalObject.height+n),o=this.originalObject.type==="image"?r/this.originalObject.originalAspectRatio:this.originalObject.width,this.originalObject.type==="image"&&(a=(this.originalObject.width-o)/2));this.objects.update(l=>l.map(w=>w.id===e?j(M({},w),{width:o,height:r,x:this.originalObject.x+a,y:this.originalObject.y+c}):w))}handleRotate(e,t,n){if(!this.originalObject)return;let i=this.objects().find(l=>l.id===e);if(!i)return;let r=this.getPointerAngle(i,t,n)-this.rotateStartAngle,a=this.rotateStartRotation+r,c=this.snapAngleWithin(a,45,2);this.objects.update(l=>l.map(w=>w.id===e?j(M({},w),{rotation:c}):w))}getPointerAngle(e,t,n){let i=(e.x+e.width/2)*this.zoom()+this.viewportX(),o=(e.y+e.height/2)*this.zoom()+this.viewportY();return Math.atan2(n-o,t-i)*(180/Math.PI)}getObjectStyle(e){return{left:`${e.x}px`,top:`${e.y}px`,width:`${e.width}px`,height:`${e.height}px`,transform:`rotate(${e.rotation}deg)`}}snapAngle(e,t=45){return Math.round(e/t)*t}snapAngleWithin(e,t=45,n=2){let i=Math.round(e/t)*t;return Math.abs(e-i)<=n?i:e}getHandlePosition(e,t){return{"scale-nw":{top:"-5px",left:"-5px"},"scale-ne":{top:"-5px",right:"-5px"},"scale-sw":{bottom:"-5px",left:"-5px"},"scale-se":{bottom:"-5px",right:"-5px"},rotate:{top:"-30px",left:"50%",transform:"translateX(-50%)"}}[t.type]||{}}getCanvasObjectsStyle(){return{transform:`translate(${this.viewportX()}px, ${this.viewportY()}px) scale(${this.zoom()})`,"transform-origin":"0 0"}}getDotGridStyle(){let t=this.gridSize()*this.zoom(),n=this.viewportX()%t,i=this.viewportY()%t;return{"background-size":`${t}px ${t}px`,"background-position":`${n}px ${i}px`,opacity:this.gridOpacity().toString()}}getInverseScaleStyle(e){let t=1/this.zoom();return{transform:`scale(${t})`,"--inverse-scale":t.toString()}}getSelectionBorderStyle(){return{"--inverse-scale":(1/this.zoom()).toString()}}onIframeLoad(e,t){let n=e.target;if(!n)return;let i=()=>{try{let o=n.contentDocument||n.contentWindow?.document||null;if(!o)return;let r=this.interactiveIframeId()===t,a=r?"auto":"hidden";o.documentElement&&(o.documentElement.style.overflow=a),o.body&&(o.body.style.overflow=a);let c=o.head?.querySelector("style[data-iframe-scroll]");if(c&&c.remove(),!r){let l=o.createElement("style");l.setAttribute("data-iframe-scroll","true"),l.textContent="::-webkit-scrollbar{display:none} html,body{overflow:hidden!important}",o.head?.appendChild(l)}}catch{}};i(),this.iframeScrollUpdateMap.set(n,i)}normalizeAngle180(e){let t=e%180;return t<0&&(t+=180),t}getCursorForHandle(e,t){let n=this.normalizeAngle180(e.rotation),i=n>=45&&n<=135,o=n<45||n>135;if(t.startsWith("scale-"))switch(t){case"scale-nw":case"scale-se":return o?"nwse-resize":"nesw-resize";case"scale-ne":case"scale-sw":return o?"nesw-resize":"nwse-resize";case"scale-w":case"scale-e":return i?"ns-resize":"ew-resize";case"scale-n":case"scale-s":return i?"ew-resize":"ns-resize"}return"move"}buildRotateCursorSvg(e){let t=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<g transform="rotate(${e} 12 12)">
<g clip-path="url(#clip0_325_17)">
<g filter="url(#filter0_d_325_17)">
<path d="M11 6C11.9193 6 12.8295 6.18106 13.6788 6.53284C14.5281 6.88463 15.2997 7.40024 15.9497 8.05025C16.5998 8.70026 17.1154 9.47194 17.4672 10.3212C17.8189 11.1705 18 12.0807 18 13V16H22L16 22L10 16H14V13C14 12.606 13.9224 12.2159 13.7716 11.8519C13.6209 11.488 13.3999 11.1573 13.1213 10.8787C12.8427 10.6001 12.512 10.3791 12.1481 10.2284C11.7841 10.0776 11.394 10 11 10H8V14L2 8L8 2V6H11Z" fill="white"/>
<path d="M11 9H7V11.5L3.5 8L7 4.5L7 7H11C11.7879 7 12.5682 7.15519 13.2961 7.45672C14.0241 7.75825 14.6855 8.20021 15.2426 8.75736C15.7998 9.31451 16.2418 9.97594 16.5433 10.7039C16.8448 11.4319 17 12.2121 17 13V17L19.5 17L16 20.5L12.5 17H15V13C15 12.4747 14.8965 11.9546 14.6955 11.4693C14.4945 10.984 14.1999 10.543 13.8284 10.1716C13.457 9.80014 13.016 9.5055 12.5307 9.30448C12.0454 9.10346 11.5253 9 11 9Z" fill="black"/>
</g>
</g>
<defs>
<filter id="filter0_d_325_17" x="0.2" y="1.2" width="23.6" height="23.6" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dy="1"/>
<feGaussianBlur stdDeviation="0.9"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.65 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_325_17"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_325_17" result="shape"/>
</filter>
<clipPath id="clip0_325_17">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>
</g>
</svg>`;return`url("data:image/svg+xml;utf8,${encodeURIComponent(t).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}") 12 12, auto`}getRotateCursor(e,t){let i={ne:0,nw:270,sw:180,se:90}[t]+e.rotation;return this.buildRotateCursorSvg(i)}scheduleHashUpdate(){if(S(this.platformId)){if(this.suppressHash){this.hashDirty=!0;return}this.hashUpdateHandle&&window.clearTimeout(this.hashUpdateHandle),this.hashUpdateHandle=window.setTimeout(()=>{let e=this.serializeStateToHash(),t=e?`#${e}`:"";if(console.log("[Canvas] scheduleHashUpdate - serialized hash:",t),t!==this.lastSerializedHash){console.log("[Canvas] scheduleHashUpdate - updating hash and sessionStorage"),window.location.hash=t,this.lastSerializedHash=t;try{sessionStorage.setItem("canvasLastHash",t)}catch{}}this.hashDirty=!1,this.hashUpdateHandle=null},this.hashThrottleMs)}}serializeStateToHash(){let e=[];e.push(this.serializeCanvasSegment());for(let t of this.objects())e.push(this.serializeObjectSegment(t));return e.join("#")}serializeCanvasSegment(){let e=this.roundNumber(this.viewportX()),t=this.roundNumber(this.viewportY()),n=this.roundNumber(this.zoom());return`canvas/${e},${t},${n}`}serializeObjectSegment(e){let t=this.roundNumber(e.x),n=this.roundNumber(e.y),i=this.roundNumber(e.width/this.baseSize),o=this.roundNumber(e.rotation),r=e.width===0?1:e.height/e.width,a=[`type:${e.type}`,`ratio:${this.roundNumber(r)}`];return e.displayMode&&a.push(`mode:${e.displayMode}`),e.ogImage&&a.push(`og:${encodeURIComponent(e.ogImage)}`),`${encodeURIComponent(e.sourceRef)}/${t},${n},${i},${o}/${a.join(",")}`}applyHashState(e){if(!S(this.platformId)||!e||e.length<=1)return;let t=e.substring(1).split("#").filter(Boolean);if(t.length===0)return;let n=[],i=this.viewportX(),o=this.viewportY(),r=this.zoom();for(let a of t){let[c,l,w]=a.split("/");if(!c||!l)continue;let u=decodeURIComponent(c);if(u==="canvas"){let[A,Z,q]=l.split(",").map(parseFloat);Number.isNaN(A)||(i=A),Number.isNaN(Z)||(o=Z),Number.isNaN(q)||(r=Math.max(.1,Math.min(5,q)));continue}let[f,y,$,E]=l.split(",").map(parseFloat);if([f,y,$,E].some(A=>Number.isNaN(A)))continue;let T=this.parseFlags(w),U=T.get("ratio")??1,B=typeof U=="number"?U:parseFloat(String(U)),G=Number.isNaN(B)?1:B,V=T.get("type")??"image",he=T.get("mode")??"image",pe=T.get("og")?decodeURIComponent(String(T.get("og"))):void 0,K=this.baseSize*$,me=K*G,D=this.resolveContent(u,V);if(!D)if(V==="image")D=this.transparentPixel;else continue;n.push({id:this.generateId(),type:V,x:f,y,width:K,height:me,rotation:E,content:D,sourceRef:u,originalAspectRatio:G,safeUrl:V==="iframe"&&this.isValidUrl(D)?this.sanitizer.bypassSecurityTrustResourceUrl(D):void 0,ogImage:pe,displayMode:he})}this.viewportX.set(i),this.viewportY.set(o),this.zoom.set(r),this.objects.set(n),this.selectedObjectId.set(null),this.lastSerializedHash=e.startsWith("#")?e:`#${e}`;try{sessionStorage.setItem("canvasLastHash",this.lastSerializedHash)}catch{}for(let a of n)a.type==="iframe"&&!a.ogImage&&this.isValidUrl(a.content)&&this.fetchOgImage(a.content,a.id)}resolveContent(e,t){if(e.startsWith("token:")){let i=e.substring(6);return this.readDataToken(i)??null}let n=this.readFileContent(e);return n||(t==="iframe"?this.isValidUrl(e)?e:null:e.startsWith("http://")||e.startsWith("https://")?e:null)}parseFlags(e){let t=new Map;if(!e)return t;for(let n of e.split(",")){let[i,o]=n.split(":");if(!i||o===void 0)continue;let r=parseFloat(o);t.set(i,Number.isNaN(r)?o:r)}return t}deriveSourceRef(e,t){if(!S(this.platformId))return e;if(e.startsWith("data:")){if(t){let i=this.makeFileKey(t);try{return localStorage.setItem(i,e),t}catch{}}return this.createDataToken(e)}return t??e}roundNumber(e){return Math.round(e*1e3)/1e3}createDataToken(e){let t=`${this.dataTokenPrefix}${Date.now()}-${Math.random().toString(36).slice(2,8)}`;try{localStorage.setItem(t,e)}catch{this.ephemeralTokens.set(t,e)}return`token:${t}`}readDataToken(e){try{let t=localStorage.getItem(e);if(t)return t}catch{}return this.ephemeralTokens.get(e)??null}makeFileKey(e){return`${this.dataFilePrefix}${e}`}readFileContent(e){let t=this.makeFileKey(e);try{return localStorage.getItem(t)}catch{return null}}generateId(){return"obj-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}cleanupObjectStorage(e){if(e.sourceRef&&!e.sourceRef.startsWith("token:")&&!e.sourceRef.startsWith("http")){let t=this.makeFileKey(e.sourceRef);try{localStorage.removeItem(t)}catch{}}else if(e.sourceRef?.startsWith("token:")){let t=e.sourceRef.substring(6);try{localStorage.removeItem(t)}catch{}this.ephemeralTokens.delete(t)}}async renderCompositionToBlob(){if(!S(this.platformId)||this.objects().length===0)return null;try{let e=this.calculateCompositionBounds();if(!e)return null;let t=1080,n=8,i=document.createElement("canvas");i.width=t,i.height=t;let o=i.getContext("2d");if(!o)return null;let r=t-2*n,a=r/e.width,c=r/e.height,l=Math.min(a,c),w=e.width*l,u=e.height*l,f=(t-w)/2,y=(t-u)/2;return await this.renderObjectsToCanvas(o,e,l,f,y),await new Promise(E=>{i.toBlob(E,"image/png")})}catch(e){return console.error("Error rendering composition:",e),null}}async downloadImage(){try{let e=await this.renderCompositionToBlob();if(!e)return;let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t;let i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);n.download=`composition-${i}.png`,n.click(),URL.revokeObjectURL(t)}catch(e){console.error("Error downloading image:",e)}}async shareImage(){try{let e=await this.renderCompositionToBlob();if(!e)return;if(navigator.share&&navigator.canShare){let r={files:[new File([e],"composition.png",{type:"image/png"})],title:"My Composition"};if(navigator.canShare(r)){await navigator.share(r);return}}let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t;let i=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);n.download=`composition-${i}.png`,n.click(),URL.revokeObjectURL(t)}catch(e){console.error("Error sharing image:",e)}}calculateCompositionBounds(){let e=this.objects();if(e.length===0)return null;let t=1/0,n=1/0,i=-1/0,o=-1/0;for(let r of e){let a=this.getObjectCorners(r);for(let c of a)t=Math.min(t,c.x),n=Math.min(n,c.y),i=Math.max(i,c.x),o=Math.max(o,c.y)}return{x:t,y:n,width:i-t,height:o-n}}getObjectCorners(e){let t=e.x+e.width/2,n=e.y+e.height/2,i=e.rotation*Math.PI/180,o=Math.cos(i),r=Math.sin(i);return[{x:-e.width/2,y:-e.height/2},{x:e.width/2,y:-e.height/2},{x:e.width/2,y:e.height/2},{x:-e.width/2,y:e.height/2}].map(c=>({x:t+c.x*o-c.y*r,y:n+c.x*r+c.y*o}))}async renderObjectsToCanvas(e,t,n,i,o){for(let r of this.objects()){e.save();let a=r.x-t.x,c=r.y-t.y,l=i+(a+r.width/2)*n,w=o+(c+r.height/2)*n;e.translate(l,w),e.rotate(r.rotation*Math.PI/180);let u=r.width*n,f=r.height*n;if(r.type==="image")try{let y=await this.loadImage(r.content);e.drawImage(y,-u/2,-f/2,u,f)}catch(y){console.warn("Failed to load image:",y),e.fillStyle="#ddd",e.fillRect(-u/2,-f/2,u,f)}else if(r.type==="iframe")if(r.ogImage&&r.displayMode!=="iframe")try{let y=await this.loadImage(r.ogImage);e.drawImage(y,-u/2,-f/2,u,f)}catch(y){console.warn("Failed to load og:image:",y),e.fillStyle="#ddd",e.fillRect(-u/2,-f/2,u,f)}else e.fillStyle="#fff",e.strokeStyle="#007bff",e.lineWidth=2,e.fillRect(-u/2,-f/2,u,f),e.strokeRect(-u/2,-f/2,u,f),e.fillStyle="#333",e.font=`${Math.max(12,f*.1)}px sans-serif`,e.textAlign="center",e.textBaseline="middle",e.fillText("Web Content",0,0);e.restore()}}loadImage(e){return new Promise((t,n)=>{let i=new Image;(e.startsWith("http://")||e.startsWith("https://"))&&(i.crossOrigin="anonymous"),i.onload=()=>t(i),i.onerror=()=>n(new Error("Failed to load image")),i.src=e})}static \u0275fac=function(t){return new(t||g)};static \u0275cmp=F({type:g,selectors:[["app-canvas"]],decls:18,vars:5,consts:[[1,"canvas-container",3,"click","mousedown","drop","dragover"],[1,"dot-grid",3,"ngStyle"],[1,"canvas-objects",3,"ngStyle"],[1,"canvas-object",3,"selected","ngStyle"],[1,"zoom-controls"],[1,"zoom-counter"],[1,"zoom-reset",3,"click"],[1,"share-controls"],[1,"download-button",3,"click","disabled"],[1,"share-button",3,"click","disabled"],[1,"canvas-instructions"],[1,"canvas-object",3,"click","mousedown","ngStyle"],[1,"hover-border",3,"ngStyle"],["alt","Canvas image",1,"object-content",3,"src"],["alt","URL preview",1,"object-content",3,"src"],[1,"iframe-wrapper"],[1,"iframe-wrapper",3,"mouseenter","mouseleave"],["sandbox","allow-scripts allow-same-origin allow-forms",1,"object-content",3,"load","src"],[1,"iframe-overlay"],[1,"iframe-overlay",3,"click"],[1,"iframe-overlay-message"],[1,"display-mode-toggle",3,"ngStyle"],[1,"selection-border",3,"ngStyle"],[1,"handle","handle-corner","handle-nw",3,"mousedown","ngStyle"],[1,"handle","handle-corner","handle-ne",3,"mousedown","ngStyle"],[1,"handle","handle-corner","handle-sw",3,"mousedown","ngStyle"],[1,"handle","handle-corner","handle-se",3,"mousedown","ngStyle"],[1,"handle","handle-edge","handle-w",3,"mousedown","ngStyle"],[1,"handle","handle-edge","handle-e",3,"mousedown","ngStyle"],[1,"handle","handle-edge","handle-n",3,"mousedown","ngStyle"],[1,"handle","handle-edge","handle-s",3,"mousedown","ngStyle"],[1,"rotation-indicator","rotation-nw",3,"mousedown","ngStyle"],[1,"rotation-indicator","rotation-ne",3,"mousedown","ngStyle"],[1,"rotation-indicator","rotation-sw",3,"mousedown","ngStyle"],[1,"rotation-indicator","rotation-se",3,"mousedown","ngStyle"],["title","Show as image",1,"toggle-btn",3,"click"],["width","16","height","16","viewBox","0 0 16 16","fill","currentColor"],["d","M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"],["d","M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"],["title","Show as website",1,"toggle-btn",3,"click"],["d","M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97 0 0 0 5.145 4H7.5V1.077zM4.09 4a9.267 9.267 0 0 1 .64-1.539 6.7 6.7 0 0 1 .597-.933A7.025 7.025 0 0 0 2.255 4H4.09zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958 0 0 0-.656 2.5h2.49zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5H4.847zM8.5 5v2.5h2.99a12.495 12.495 0 0 0-.337-2.5H8.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5H4.51zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5H8.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12H5.145zm.182 2.472a6.696 6.696 0 0 1-.597-.933A9.268 9.268 0 0 1 4.09 12H2.255a7.024 7.024 0 0 0 3.072 2.472zM3.82 11a13.652 13.652 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5H3.82zm6.853 3.472A7.024 7.024 0 0 0 13.745 12H11.91a9.27 9.27 0 0 1-.64 1.539 6.688 6.688 0 0 1-.597.933zM8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068H8.5zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.65 13.65 0 0 1-.312 2.5zm2.802-3.5a6.959 6.959 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5h2.49zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024 0 0 0-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4h2.355z"]],template:function(t,n){t&1&&(d(0,"div",0),v("click",function(o){return n.onCanvasClick(o)})("mousedown",function(o){return n.onCanvasMouseDown(o)})("drop",function(o){return n.onDrop(o)})("dragover",function(o){return n.onDragOver(o)}),O(1,"div",1),d(2,"div",2),ie(3,Me,5,6,"div",3,fe),p(),d(5,"div",4)(6,"div",5),P(7),p(),d(8,"button",6),v("click",function(){return n.resetZoom()}),P(9,"Reset"),p()(),d(10,"div",7)(11,"button",8),v("click",function(){return n.downloadImage()}),P(12," Download "),p(),d(13,"button",9),v("click",function(){return n.shareImage()}),P(14," Share "),p()(),d(15,"div",10)(16,"p"),P(17,"Drag and drop images here \u2022 Paste URLs (Ctrl/Cmd+V) \u2022 Drag canvas to pan \u2022 Scroll to zoom"),p()()()),t&2&&(h(),m("ngStyle",n.getDotGridStyle()),h(),m("ngStyle",n.getCanvasObjectsStyle()),h(),oe(n.objects()),h(4),re("",n.zoomPercentage(),"%"),h(4),m("disabled",n.objects().length===0),h(2),m("disabled",n.objects().length===0))},dependencies:[se,ae],styles:['[_nghost-%COMP%]{display:block;width:100%;height:100%}.canvas-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;overflow:hidden;background-color:#121212;cursor:grab}.canvas-container[_ngcontent-%COMP%]:active{cursor:grabbing}.dot-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-image:radial-gradient(circle,rgba(255,255,255,.14) 1px,transparent 1px);background-size:20px 20px;background-position:0 0;pointer-events:none;z-index:1;transition:opacity .3s ease-in-out}.canvas-objects[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2;pointer-events:none}.canvas-object[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;cursor:move;-webkit-user-select:none;user-select:none;pointer-events:auto}.canvas-object.selected[_ngcontent-%COMP%]   .selection-border[_ngcontent-%COMP%]{display:block}.canvas-object[_ngcontent-%COMP%]   .object-content[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;pointer-events:none;display:block;border:none}.canvas-object[_ngcontent-%COMP%]   .iframe-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.canvas-object[_ngcontent-%COMP%]   iframe.object-content[_ngcontent-%COMP%]{overflow:hidden;scrollbar-width:none;transition:opacity .2s ease-in-out}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.dimmed[_ngcontent-%COMP%]{opacity:.4}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]{pointer-events:auto;opacity:1;overflow:auto!important;scrollbar-width:auto}.canvas-object[_ngcontent-%COMP%]   iframe.object-content[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]::-webkit-scrollbar{display:block;width:12px;height:12px}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0000004d;border-radius:6px}.canvas-object[_ngcontent-%COMP%]   iframe.object-content.interactive[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#0000001a}.canvas-object[_ngcontent-%COMP%]   .iframe-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000059;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1;pointer-events:auto}.canvas-object[_ngcontent-%COMP%]   .iframe-overlay[_ngcontent-%COMP%]   .iframe-overlay-message[_ngcontent-%COMP%]{background-color:#1e1e1ef2;color:#f0f0f0;padding:12px 24px;border-radius:8px;font-size:16px;font-weight:600;box-shadow:0 2px 12px #0006;-webkit-user-select:none;user-select:none;transition:transform .1s ease}.canvas-object[_ngcontent-%COMP%]   .iframe-overlay[_ngcontent-%COMP%]   .iframe-overlay-message[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.canvas-object[_ngcontent-%COMP%]   .selection-border[_ngcontent-%COMP%]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;border-style:solid;border-color:#007bff;border-width:calc(1px * var(--inverse-scale, 1));box-sizing:border-box;pointer-events:none;transform-origin:0 0}.canvas-object[_ngcontent-%COMP%]:hover   .selection-border[_ngcontent-%COMP%]{border-width:calc(3px * var(--inverse-scale, 1))}.canvas-object[_ngcontent-%COMP%]   .hover-border[_ngcontent-%COMP%]{display:none;position:absolute;top:0;left:0;width:100%;height:100%;border-style:solid;border-color:#007bff;border-width:calc(1px * var(--inverse-scale, 1));box-sizing:border-box;pointer-events:none;transform-origin:0 0}.canvas-object[_ngcontent-%COMP%]:hover   .hover-border[_ngcontent-%COMP%]{display:block}.canvas-object[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{position:absolute;pointer-events:all;z-index:10;-webkit-user-select:none;user-select:none;transform-origin:center}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner[_ngcontent-%COMP%]{width:12px;height:12px;background-color:#007bff;border:1px solid white;box-sizing:border-box}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-nw[_ngcontent-%COMP%]{top:-6px;left:-6px;cursor:nwse-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-ne[_ngcontent-%COMP%]{top:-6px;right:-6px;cursor:nesw-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-sw[_ngcontent-%COMP%]{bottom:-6px;left:-6px;cursor:nesw-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner.handle-se[_ngcontent-%COMP%]{bottom:-6px;right:-6px;cursor:nwse-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-corner[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:scale(1.3)}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge[_ngcontent-%COMP%]{background-color:transparent;border:none}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-w[_ngcontent-%COMP%]{top:0;left:-4px;width:8px;height:100%;cursor:w-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-e[_ngcontent-%COMP%]{top:0;right:-4px;width:8px;height:100%;cursor:e-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-n[_ngcontent-%COMP%]{top:-4px;left:0;width:100%;height:8px;cursor:n-resize}.canvas-object[_ngcontent-%COMP%]   .handle.handle-edge.handle-s[_ngcontent-%COMP%]{bottom:-4px;left:0;width:100%;height:8px;cursor:s-resize}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]{position:absolute;transform-origin:center;width:20px;height:20px;pointer-events:all;z-index:10;cursor:grab}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]:hover{cursor:grab}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]:active{cursor:grabbing}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator[_ngcontent-%COMP%]:before{content:"";position:absolute;width:4px;height:4px;background-color:#28a745;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%)}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-nw[_ngcontent-%COMP%]{top:-30px;left:-30px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-ne[_ngcontent-%COMP%]{top:-30px;right:-30px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-sw[_ngcontent-%COMP%]{bottom:-30px;left:-30px}.canvas-object[_ngcontent-%COMP%]   .rotation-indicator.rotation-se[_ngcontent-%COMP%]{bottom:-30px;right:-30px}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]{position:absolute;top:-50px;left:50%;transform:translate(-50%);transform-origin:center;display:flex;gap:4px;background-color:#1e1e1ef2;padding:4px;border-radius:6px;box-shadow:0 2px 8px #0006;pointer-events:all;z-index:15}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background-color:#1f1f1f;border:1px solid #3a3a3a;border-radius:4px;cursor:pointer;transition:all .2s;color:#cfcfcf;padding:0}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover{background-color:#2a2a2a;border-color:#5a5a5a;color:#fff}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;color:#fff}.canvas-object[_ngcontent-%COMP%]   .display-mode-toggle[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}.canvas-instructions[_ngcontent-%COMP%]{position:absolute;top:20px;left:50%;transform:translate(-50%);background-color:#141414e6;padding:12px 24px;border-radius:8px;box-shadow:0 2px 8px #0006;z-index:100;pointer-events:none}.canvas-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#e6e6e6;font-size:14px;font-weight:500}.zoom-controls[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%);display:flex;align-items:center;gap:8px;background-color:#141414f2;padding:8px 16px;border-radius:8px;box-shadow:0 2px 12px #00000080;z-index:100;pointer-events:auto}.zoom-controls[_ngcontent-%COMP%]   .zoom-counter[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#e6e6e6;min-width:50px;text-align:center}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;border-radius:4px;padding:6px 12px;font-size:13px;font-weight:500;cursor:pointer;transition:background-color .2s}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]:hover{background-color:#0056b3}.zoom-controls[_ngcontent-%COMP%]   .zoom-reset[_ngcontent-%COMP%]:active{background-color:#004085}.share-controls[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;display:flex;align-items:center;gap:8px;background-color:#141414f2;padding:8px 16px;border-radius:8px;box-shadow:0 2px 12px #00000080;z-index:100;pointer-events:auto}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%], .share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]{color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:13px;font-weight:500;cursor:pointer;transition:background-color .2s}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:disabled, .share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed;opacity:.6}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]{background-color:#007bff}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.share-controls[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]:active:not(:disabled){background-color:#004085}.share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]{background-color:#28a745}.share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#218838}.share-controls[_ngcontent-%COMP%]   .share-button[_ngcontent-%COMP%]:active:not(:disabled){background-color:#1e7e34}'],changeDetection:0})};var ge=class g{title=x("sample-reflect");static \u0275fac=function(t){return new(t||g)};static \u0275cmp=F({type:g,selectors:[["app-root"]],decls:3,vars:1,consts:[[3,"fullScreen"]],template:function(t,n){t&1&&(d(0,"lib-layout",0),O(1,"app-canvas")(2,"router-outlet"),p()),t&2&&m("fullScreen",!0)},dependencies:[le,de,L],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})};export{ge as App};
